var l=1,ba=0,ca=null,n=0;function p(a){return null==a||"null"==a||""==a||void 0==a||"undefined"==a||[]==a||void 0==jQuery(a).get(0).tagName}function q(a,b){a.append(b)}function r(a,b,c,e,d,f){a.css({left:b,top:c,width:e,height:d});a.css({"z-index":99999,position:"absolute","background-color":"#facd93"});a.css(f,"1px dashed #000")}function u(a,b,c,e,d){a.css({left:b,top:c,width:e,height:d});a.css({"z-index":99999,position:"absolute","background-color":"#000",opacity:.5})}
function da(a){var b="#F9AEAE #F1C194 #F3E13B #CEF57B #9CF994 #75D8BA #55C5F5 #A7A5E4 #D291FF #FF91D5 #EBD2D6".split(" "),c=b.length;a>=c&&(a=c-1);return b[a]}
function v(a,b,c,e){n+=1;var d="";b&&(d="<div class='ncx_selector' style='background-color:"+e+"; position: absolute; height: 15px; width: 35px;'><a class='ncx-highlight-button ncx-accept-highlight' lang='"+c+"' style='background: url(\""+newcrawler_server_url+"static/xpath/v2/icon-highlight-accept.svg\") no-repeat 50% 50%;background-size: 10px 10px;right: 0px;padding-right: 10px;display: inline-block;cursor: pointer!important;height: 12px;width: 12px;opacity: .4;position: absolute;margin-top: 1px;'></a><a class='ncx-highlight-button ncx-reject-highlight' lang='"+c+
"' style='background: url(\""+newcrawler_server_url+"static/xpath/v2/icon-highlight-reject.svg\") no-repeat 50% 50%;background-size: 10px 10px;right: 15px;padding-right: 10px;display: inline-block;cursor: pointer!important;height: 12px;width: 12px;opacity: .4;position: absolute;margin-top: 1px;'></a></div>");jQuery("#newcrawler").contents().find("#ncx_curlCover").append("<div id='ncx_traceHighlight_top_"+n+"' class='ncx_highlightTool'></div>");jQuery("#newcrawler").contents().find("#ncx_curlCover").append("<div id='ncx_traceHighlight_right_"+
n+"' class='ncx_highlightTool'></div>");jQuery("#newcrawler").contents().find("#ncx_curlCover").append("<div id='ncx_traceHighlight_bottom_"+n+"' class='ncx_highlightTool'>"+d+"</div>");jQuery("#newcrawler").contents().find("#ncx_curlCover").append("<div id='ncx_traceHighlight_left_"+n+"' class='ncx_highlightTool'></div>");b=jQuery("#newcrawler").contents().find("#ncx_traceHighlight_top_"+n+"");e=jQuery("#newcrawler").contents().find("#ncx_traceHighlight_right_"+n+"");var d=jQuery("#newcrawler").contents().find("#ncx_traceHighlight_bottom_"+
n+""),f=jQuery("#newcrawler").contents().find("#ncx_traceHighlight_left_"+n+"");c=jQuery(a).offset();var g=jQuery(a).outerWidth();a=jQuery(a).outerHeight();var h=jQuery("#newcrawler").contents().width();g>h&&(g=h-8);r(b,c.left-2,c.top-2,g+4,2,"border-bottom");r(e,c.left+g,c.top,2,a,"border-left");r(d,c.left-2,c.top+a,g+4,2,"border-top");r(f,c.left-2,c.top,2,a,"border-right")}
function ea(a){jQuery("#newcrawler").contents().find("#ncx_curlCover .ncx_highlightTool").remove();var b=jQuery(a).offset().top,c=jQuery(a).offset().left,e=jQuery(a).outerWidth(),d=jQuery(a).outerHeight(),f=jQuery("#newcrawler").contents().outerHeight(),g=jQuery("#newcrawler").contents().outerWidth();e>g+8&&(e=g);q(jQuery("#newcrawler").contents().find("#ncx_curlCover"),"<div id='ncx_highlightCover_top' class='ncx_highlightTool'></div>");q(jQuery("#newcrawler").contents().find("#ncx_curlCover"),"<div id='ncx_highlightCover_right' class='ncx_highlightTool'></div>");
q(jQuery("#newcrawler").contents().find("#ncx_curlCover"),"<div id='ncx_highlightCover_bottom' class='ncx_highlightTool'></div>");q(jQuery("#newcrawler").contents().find("#ncx_curlCover"),"<div id='ncx_highlightCover_left' class='ncx_highlightTool'></div>");var h=jQuery("#newcrawler").contents().find("#ncx_highlightCover_top"),k=jQuery("#newcrawler").contents().find("#ncx_highlightCover_right"),m=jQuery("#newcrawler").contents().find("#ncx_highlightCover_bottom"),t=jQuery("#newcrawler").contents().find("#ncx_highlightCover_left");
u(h,0,0,g+8,b-3);u(k,c+3+e,b-3,g-c-3-e+8,d+6);u(m,0,b+3+d,g+8,f-b-d+155);u(t,0,b-3,c-3,d+6);l=0;q(jQuery("#newcrawler").contents().find("#ncx_curlCover"),"<div id='ncx_editHighlight_top' class='ncx_highlightTool'></div>");q(jQuery("#newcrawler").contents().find("#ncx_curlCover"),"<div id='ncx_editHighlight_right' class='ncx_highlightTool'></div>");q(jQuery("#newcrawler").contents().find("#ncx_curlCover"),"<div id='ncx_editHighlight_bottom' class='ncx_highlightTool'></div>");q(jQuery("#newcrawler").contents().find("#ncx_curlCover"),
"<div id='ncx_editHighlight_left' class='ncx_highlightTool'></div>");b=jQuery("#newcrawler").contents().find("#ncx_editHighlight_top");c=jQuery("#newcrawler").contents().find("#ncx_editHighlight_right");d=jQuery("#newcrawler").contents().find("#ncx_editHighlight_bottom");f=jQuery("#newcrawler").contents().find("#ncx_editHighlight_left");g=jQuery(a).offset();r(b,g.left-2,g.top-2,e+4,2,"border-bottom");r(c,g.left+e,g.top,2,jQuery(a).outerHeight(),"border-left");r(d,g.left-2,g.top+jQuery(a).outerHeight(),
e+4,2,"border-top");r(f,g.left-2,g.top,2,jQuery(a).outerHeight(),"border-right");jQuery("#newcrawler").contents().find("#ncx_curlCover .ncx_highlightTool").click(function(){w()})}
function w(){jQuery("#newcrawler").contents().find("#ncx_curlCover .ncx_highlightTool").remove();jQuery("#newcrawler-selector").find("#ncx_edit_tpl_tool").remove();l=1;jQuery("#newcrawler").contents().find("#ncx_curlCover").css({"pointer-events":"none"});0==x&&jQuery("#ncx_toolbar .ncx-datatypes .active .ncx-count").text("0")}
function y(a,b,c){jQuery("#newcrawler").contents().find("#ncx_curlCover .ncx_highlightTool").remove();var e=null,d=0;if(!x&&1<z.length){for(var e=z[1].a,f=1,g=z.length;f<g;f++)for(var h=0,k=z[f].a.length;h<k;h++)-1!=z[f].a[h].indexOf(":nth-of-type(*)")&&(e=z[f].a);d=e.length}k=0;if(!c)for(f=0,g=A.length;f<g;f++)if(-1!=A[f].indexOf(":nth-of-type(*)")){if(null!=e)if(d>f){if(-1==e[f].indexOf(":nth-of-type(*)")){A[f]=B[f];continue}}else{A[f]=B[f];continue}k++}c=!1;if(0<k)c=!0,jQuery("#newcrawler-selector").find("#ncx_edit_tpl_tool").remove(),
b=l=1;else{ea(a);1===b?fa(a):ga(a);f=A.join("");jQuery("#newcrawler-selector").find("#ncx_copy_xpath_text").text(f);g=jQuery(a).get(0);jQuery("#newcrawler-selector").find("select[name='ncx_attr']").empty();jQuery("#newcrawler-selector").find("select[name='ncx_attr']").append('<option value=""></option>');d=!1;f=0;k=g.attributes;for(e=k.length;f<e;f++)d=k[f].nodeName.toLowerCase(),jQuery("#newcrawler-selector").find("select[name='ncx_attr']").append('<option value="'+d+'">'+d+"</option>"),d=!0;d?(jQuery("#newcrawler-selector").find("input[name='ncx_selectType'][value='@ATTR']").attr("disabled",
!1),jQuery("#newcrawler-selector").find("select[name='ncx_attr']").attr("disabled",!1)):(jQuery("#newcrawler-selector").find("input[name='ncx_selectType'][value='@ATTR']").attr("disabled",!0),jQuery("#newcrawler-selector").find("select[name='ncx_attr']").attr("disabled",!0));("img"==g.tagName.toLowerCase()||x)&&d?(jQuery("#newcrawler-selector").find("select[name='ncx_attr'] option:nth-child(2)").attr("selected",!0),jQuery("#newcrawler-selector").find("input[name='ncx_selectType'][value='@ATTR']").attr("checked",
!0),jQuery("#newcrawler-selector").find("select[name='ncx_attr']").change()):(jQuery("#newcrawler-selector").find("input[name='ncx_selectType'][value='innerHTML']").attr("checked",!0),f=g.innerHTML,jQuery("#newcrawler-selector").find("#ncx_content_preview").text(C(f)))}k=0;e=[];f=d=0;for(g=A.length;f<g;f++)if(e[f]=A[f],-1!=e[f].indexOf(":nth-of-type(*)")){for(h=f+1;h<g;h++)e[h]=B[h];var h=e.join(""),h=h.replace(":nth-of-type(*)",""),h=jQuery("#newcrawler").contents().find(h),m=h.length,k=k+m,t=da(d);
d++;for(var S=0;S<m;S++){var T=h[S];D(a,T)?v(T,!1,f,null):v(T,c,f,t)}e[f]=B[f]}0==k&&k++;x||jQuery("#ncx_toolbar .ncx-datatypes .active .ncx-count").text(k);jQuery("#newcrawler").contents().find(".ncx-accept-highlight").unbind("click").click(function(){for(var c=jQuery(this).attr("lang"),e=0,d=A.length;e<d;e++)-1!=A[e].indexOf(":nth-of-type(*)")&&c!=e&&(A[e]=B[e]);y(a,b,!0)});jQuery("#newcrawler").contents().find(".ncx-reject-highlight").unbind("click").click(function(){for(var c=jQuery(this).attr("lang"),
e=0,d=A.length;e<d;e++)-1!=A[e].indexOf(":nth-of-type(*)")&&c==e&&(A[e]=B[e]);y(a,b,!1)})}function C(a){return a=a.replaceAll("<ncx-text>","").replaceAll("</ncx-text>","")}var E=0,F=[],G={},A=[],B=[];function ha(a){F.push(a);a=jQuery(a).parent();var b=a.get(0);return p(b)?F:ha(a)}
function fa(a){G=a;jQuery("#newcrawler-selector").find("#ncx_edit_tpl_tool").remove();var b=H("et_wrap");q(jQuery("#newcrawler-selector"),b);I("ncx_et_state_10");ia();F=[];ha(a);jQuery("#newcrawler-selector").find("#ncx_edit_tpl_tool").removeData("child");jQuery("#newcrawler-selector").find("#ncx_edit_tpl_tool").data("child",F);setTimeout(function(){ja(a)},1)}
function ga(a){G=a;ja(a);a=jQuery(G).get(0).innerHTML;jQuery("#newcrawler-selector").find("#ncx_content_preview").text(C(a));jQuery("#newcrawler-selector").find("#ncx_copy_xpath_tips").text("");jQuery("#newcrawler-selector").find("#ncx_copy_xpath_text").css({"background-color":"white"});jQuery("#newcrawler-selector").find("#ncx_copy_csspath_tips").text("");jQuery("#newcrawler-selector").find("#ncx_copy_csspath_text").css({"background-color":"white"})}
function ja(a){jQuery(a).offset();jQuery("#newcrawler").outerHeight();var b=jQuery("#newcrawler").offset().top,c=jQuery("#newcrawler").contents().scrollTop(),e=jQuery(a).offset().top,e=e-c+b,b=jQuery(a).offset().left,c=jQuery(a).outerWidth(),d=jQuery(a).outerHeight(),f=jQuery("#newcrawler").outerHeight();a=jQuery("#newcrawler").outerWidth();var g=jQuery("#newcrawler-selector").find("#ncx_edit_tpl_tool").outerHeight();f-e-d<g?(f=b+c-400,f=b-3,e=e-g-2,0>=f&&(f=0),f+400>a&&(f=b+c-400+3,f>a&&(f=a-400-
10)),jQuery("#newcrawler-selector").find("#ncx_edit_tpl_tool").css({left:f+"px",top:e+"px"})):(f=b+c-400,f=b-3,e=e+d+3,0>=f&&(f=0),f+400>a&&(f=b+c-400+3,f>a&&(f=a-400-10)),jQuery("#newcrawler-selector").find("#ncx_edit_tpl_tool").css({left:f+"px",top:e+"px"}));jQuery("#newcrawler-selector").find("#ncx_edit_tpl_tool").css({opacity:"1"});var h=jQuery("#newcrawler-selector").find("#ncx_edit_tpl_tool"),k=h.offset().top,m=jQuery(jQuery("#newcrawler").contents()).scrollTop();jQuery(jQuery("#newcrawler").contents()).on("scroll",
function(){var a=jQuery(this).scrollTop()-m,a=k-a;h.stop(!1,!1).animate({top:47>a?47:a},0)})}
function H(a){var b="";switch(a){case "et_wrap":b="<div class='ncx_edit_tpl_tool' style='opacity: 0;position : absolute; z-index : 999990;' id='ncx_edit_tpl_tool'><ul id='ncx_et_bar' class='ncx_et_bar'><li class='ncx_col1'><div id='ncx_larger' class='ncx_larger'></div><div id='ncx_smaller' class='ncx_smaller'></div></li><li class='ncx_col4' id='ncx_et_state_4'><span class='ncx_bar_button_tilte'>Preview</span></li>";b+="</ul><div id='ncx_et_content' class='ncx_et_content'></div></div>";break;case "et_conetent_inner_20":b=
"<div class='ncx_et_content_inner' id='ncx_copy_xpath_container' style='position:relative'><pre id='ncx_copy_xpath_text' class='ncx_xpath'>xpath express test!!!</pre>";b+="<div class='ncx_button'><button id='ncx_copy_xpath_button' class='ncx_xpath_copy'>Copy Selector</button><button class='ncx_et_cancel'></button></div>";b+="<div id='ncx_copy_xpath_tips' class='ncx_tips'></div>";b+="</div>";break;case "et_conetent_inner_30":b="<div class='ncx_et_content_inner' id='ncx_copy_csspath_container' style='position:relative'><pre id='ncx_copy_csspath_text' class='ncx_csspath'>csspath express test!!!</pre>";
b+="<div class='ncx_button'><button id='ncx_copy_csspath_button' class='ncx_csspath_copy'>Copy Selector</button><button class='ncx_et_cancel'></button></div>";b+="<div id='ncx_copy_csspath_tips' class='ncx_tips'></div>";b+="</div>";break;case "et_conetent_inner_40":b="<div class='ncx_et_content_inner'><div><input name='ncx_property_name' type='text' value='' placeholder='Property Name' style='vertical-align: middle;height: 25px;'></div>",b+="<div><pre id='ncx_copy_xpath_text' class='ncx_xpath ncx_expression'>xpath express test!!!</pre></div>",
b+="<div style='height: 22px;'>",b+="<div style='float:left;margin-left:0px;width:80px;'><input name='ncx_selectType' type='radio' value='outerHTML' style='vertical-align: middle;'><span>outerHTML</span></div>",b+="<div style='float:left;margin-left:0px;width:80px;'><input name='ncx_selectType' type='radio' value='innerHTML' style='vertical-align: middle;' checked='checked' ><span>innerHTML</span></div>",b+="<div style='float:left;margin-left:0px;width:80px;'><input name='ncx_selectType' type='radio' value='innerTEXT' style='vertical-align: middle;'><span>innerTEXT</span></div>",
b+="<div style='float:left;margin-left:0px;width:80px;'><input name='ncx_selectType' type='radio' value='@ATTR' style='vertical-align: middle;display:none;'><span><select name='ncx_attr' style='width: 130px;'></select></span></div>",b+="</div>",b+="<div><pre id='ncx_content_preview' class='ncx_content'></pre></div>",b+="<div class='ncx_button'>",b+="<button id='ncx_copy_xpath_button' class='ncx_xpath_copy'>Copy Selector</button>",b+="<button class='ncx_et_cancel'></button>",b+="<button class='ncx_et_create'></button>",
b+="</div>",b+="<div class='ncx_tips'></div></div>"}return b}
function J(){var a=new ZeroClipboard(document.getElementById("ncx_copy_csspath_button"));a.on("ready",function(){a.on("copy",function(a){a.clipboardData.setData("text/plain",jQuery("#newcrawler-selector").find("#ncx_copy_csspath_text").text())});a.on("aftercopy",function(){jQuery("#newcrawler-selector").find(".ncx_et_content_inner .ncx_tips").text("Copied CssPath.");jQuery("#newcrawler-selector").find(".ncx_et_content_inner .ncx_expression").css({"background-color":"white"});jQuery("#newcrawler-selector").find("#ncx_copy_csspath_text").css({"background-color":"rgb(236, 248, 233)"})})});
var b=new ZeroClipboard(document.getElementById("ncx_copy_xpath_button"));b.on("ready",function(){b.on("copy",function(a){a.clipboardData.setData("text/plain",jQuery("#newcrawler-selector").find("#ncx_copy_xpath_text").text())});b.on("aftercopy",function(){jQuery("#newcrawler-selector").find(".ncx_et_content_inner .ncx_tips").text("Copied XPath.");jQuery("#newcrawler-selector").find(".ncx_et_content_inner .ncx_expression").css({"background-color":"white"});jQuery("#newcrawler-selector").find("#ncx_copy_xpath_text").css({"background-color":"rgb(236, 248, 233)"})})})}
function I(a){jQuery("#newcrawler-selector").find("#ncx_et_bar").removeClass("ncx_shape1");jQuery("#newcrawler-selector").find(".ncx_bar_button_tilte").removeClass("ncx_on");jQuery("#newcrawler-selector").find("#ncx_et_content").removeClass("ncx_shape1");jQuery("#newcrawler-selector").find("#ncx_et_content").empty();switch(a){case "ncx_et_state_10":jQuery("#newcrawler-selector").find("#ncx_et_bar").addClass("ncx_shape1");break;case "ncx_et_state_20":jQuery("#newcrawler-selector").find("#ncx_et_bar").addClass("ncx_shape1");
jQuery("#newcrawler-selector").find(".ncx_col2 > .ncx_bar_button_tilte").addClass("ncx_on");jQuery("#newcrawler-selector").find("#ncx_et_content").addClass("ncx_shape1");a=H("et_conetent_inner_20");q(jQuery("#newcrawler-selector").find("#ncx_et_content"),a);a=K(jQuery(G).get(0));jQuery("#newcrawler-selector").find("#ncx_copy_xpath_text").text(a);J();break;case "ncx_et_state_30":jQuery("#newcrawler-selector").find("#ncx_et_bar").addClass("ncx_shape1");jQuery("#newcrawler-selector").find(".ncx_col3 > .ncx_bar_button_tilte").addClass("ncx_on");
jQuery("#newcrawler-selector").find("#ncx_et_content").addClass("ncx_shape1");a=H("et_conetent_inner_30");q(jQuery("#newcrawler-selector").find("#ncx_et_content"),a);a=K(jQuery(G).get(0));jQuery("#newcrawler-selector").find("#ncx_copy_csspath_text").text(a);J();break;case "ncx_et_state_40":jQuery("#newcrawler-selector").find("#ncx_et_bar").addClass("ncx_shape1"),jQuery("#newcrawler-selector").find(".ncx_col4 > .ncx_bar_button_tilte").addClass("ncx_on"),jQuery("#newcrawler-selector").find("#ncx_et_content").addClass("ncx_shape1"),
a=H("et_conetent_inner_40"),q(jQuery("#newcrawler-selector").find("#ncx_et_content"),a),jQuery(G).get(0),jQuery("#newcrawler-selector").find(".ncx_et_content_inner select[name='ncx_attr']").unbind("change").change(function(){jQuery("#newcrawler-selector").find(".ncx_et_content_inner input[name=ncx_selectType][value='@ATTR']").attr("checked",!0);if(""==this.value)jQuery("#newcrawler-selector").find(".ncx_et_content_inner input[name=ncx_selectType][value='innerHTML']").attr("checked",!0),jQuery("#newcrawler-selector").find(".ncx_et_content_inner input[name=ncx_selectType][value='innerHTML']").click();
else{var a=jQuery("#newcrawler-selector").find(".ncx_et_content_inner select[name='ncx_attr']").val();jQuery("#newcrawler-selector").find("#ncx_content_preview").text("");var c=B.join(""),c=c.replace(":nth-of-type(*)",""),c=jQuery("#newcrawler").contents().find(c);0<c.length&&jQuery("#newcrawler-selector").find("#ncx_content_preview").text(c.attr(a))}}),jQuery("#newcrawler-selector").find(".ncx_et_content_inner input[name=ncx_selectType]").unbind("click").click(function(){jQuery("#newcrawler-selector").find(".ncx_et_content_inner select[name='ncx_attr']").val("");
switch(jQuery(this).val()){case "outerHTML":var a=jQuery(G).get(0),a=a.outerHTML;jQuery("#newcrawler-selector").find("#ncx_content_preview").text(C(a));break;case "innerHTML":a=jQuery(G).get(0);a=a.innerHTML;jQuery("#newcrawler-selector").find("#ncx_content_preview").text(C(a));break;case "innerTEXT":jQuery("#newcrawler-selector").find("#ncx_content_preview").text(jQuery(G).text())}}),J()}jQuery("#newcrawler-selector").find(".ncx_et_cancel").click(function(){w()});jQuery("#newcrawler-selector").find(".ncx_et_create").click(function(){var a=
A.join(""),c=L,e=jQuery("#newcrawler-selector").find("input[name=ncx_selectType]:checked").val(),d=jQuery("#newcrawler-selector").find("select[name='ncx_attr']").val(),f=jQuery("#newcrawler-selector").find("input[name=ncx_property_name]").val();if(null==f||""==f)if(f="property",x)c=0,f="pagination";else for(var g=c;500>g;g++){for(var f="property"+g,h=!1,k=1,m=z.length;k<m;k++)if(f==z[k].name){h=!0;break}if(!h)break}M(null,c,f,a,A,e,x,d);w()})}
function ka(a){var b=[];a=a.split(" > ");for(var c=0,e=a.length;c<e;c++)""!=a[c]&&(b.push(" > "),b.push(a[c]));" > "==b[0]&&(b=b.slice(1));return b}
function M(a,b,c,e,d,f,g,h){g?z[0]={id:a,index:0,name:c,c:e,a:d,g:f,f:h}:(g=e.replace(":nth-of-type(*)",""),g=jQuery("#newcrawler").contents().find(g).length,jQuery("#ncx_toolbar .ncx-datatypes .active .ncx-count").text(g),g=jQuery("#ncx_toolbar .ncx-datatypes .active"),g.addClass("ncx-blue finished"),g.attr("title",c),g.removeClass("ncx-yellow"),g.removeClass("active"),z.push({id:a,index:b,name:c,c:e,a:d,g:f,f:h}),L+=1,jQuery('<a lang="'+L+'" class="ncx-label ncx-data-dot ncx-yellow active"><span class="ncx-count">0</span><span class="ncx-delete-datatype" style="display: none;"></span></a>').insertBefore(jQuery("#ncx_toolbar .ncx-datatypes .ncx-pagination")),
jQuery("#ncx_toolview .ncx-export-window-wordpress .ncx-export-content select.allFileds").append("<option value='${"+c+"}'>"+c+"</option>"),a=jQuery("#ncx_toolview .ncx-export-window-db .ncx-export-content .fieldMap .temp").clone(),a.removeClass("temp"),a.find(".labelName").text(c),a.find("input[name=labelName]").val("${"+c+"}"),a.find("input[name=param]").val(c),jQuery("#ncx_toolview .ncx-export-window-db .ncx-export-content .fieldMap").append(a),jQuery("#ncx_toolview .ncx-export-window-rss .ncx-export-content select.allFileds").append("<option value='"+
c+"'>"+c+"</option>"));jQuery("#ncx_toolbar .save").attr("disabled",!1);la()}function D(a,b){return void 0==a||void 0==b?!1:0==a.compareDocumentPosition(b)?!0:!1}
function K(a){A=[];for(B=[];a&&void 0!==a.tagName;a=a.parentNode){var b=a.tagName;if(!b)break;b=b.toLowerCase();if("ncx_cover-container"!=a.id){var c=jQuery(a).parent().children(b).not("#ncx_cover-container"),e=c.length,d="",f="";if(1<e)for(var g=0;g<e;g++){var h=c[g];if(D(a,h))""==d&&(d=":nth-of-type("+(g+1)+")"),f=":nth-of-type("+(g+1)+")";else if(":nth-of-type(*)"!=d)if(0<A.length){var k=B.join(""),h=jQuery(h).find(k).length;0<h&&0<h&&(d=":nth-of-type(*)")}else d=":nth-of-type(*)"}""==d&&(f=d=
"");if("html"==b||"body"==b)f=d="";d=b+d;f=b+f;b=ma(f);c=!1;e="#";g="";a.className&&!/\s/.test(a.className)?(c=!0,e=".",g=a.className):a.id&&!/\s/.test(a.id)&&(c=!0,g=a.id,isNaN(g)||(g="\\3"+a.id));if(c){if(x)for(c=!1,h=0,k=A.length;h<k;h++)if("a"==A[h]||0==A[h].indexOf("a[")){c=!0;break}if(c&&(c=e+g,ma(c)==b&&na(c,0)))if(1<z.length){if(c==z[1].a[0]){A.unshift(c);B.unshift(c);break}}else{A.unshift(c);B.unshift(c);break}}A.unshift(d);A.unshift(" > ");B.unshift(f);B.unshift(" > ")}}" > "==A[0]&&(A=
A.slice(1),B=B.slice(1));return A.join("")}function na(a,b){for(var c=b,e=!1,d=A.slice(0),f=0,g=d.length;f<g;f++)-1!=d[f].indexOf(":nth-of-type(*)")&&(f>b||0==b?c==b?(d[f]=d[f].replace(":nth-of-type(*)",""),b=f):(e=!0,d[f]=B[f]):d[f]=B[f]);d.unshift(a);a=d.join("");var h=!0,k=null;jQuery("#newcrawler").contents().find(a).each(function(){if(null==k)k=oa(this,d);else{var a=oa(this,d);if(!D(a[0],k[0]))return h=!1}});return e?h&&na(a,b):h}
function oa(a,b){for(var c=b.length/2-1,e=jQuery(a).parent(),d=0;d<c;d++)e=jQuery(e).parent();return e}function ma(a){for(var b=A.slice(0),c=0,e=b.length;c<e;c++)-1!=b[c].indexOf(":nth-of-type(*)")&&(b[c]=B[c]);b.unshift(a);a=b.join("");return jQuery("#newcrawler").contents().find(a).length}
function ia(){jQuery("#newcrawler-selector").find("#ncx_larger").mouseover(function(){jQuery(this).addClass("ncx_on")});jQuery("#newcrawler-selector").find("#ncx_smaller").mouseover(function(){jQuery(this).addClass("ncx_on")});jQuery("#newcrawler-selector").find("#ncx_larger").mouseout(function(){jQuery(this).removeClass("ncx_on")});jQuery("#newcrawler-selector").find("#ncx_smaller").mouseout(function(){jQuery(this).removeClass("ncx_on")});jQuery("#newcrawler-selector").find(".ncx_bar_button_tilte").mouseover(function(){jQuery(this).addClass("ncx_onhover")});
jQuery("#newcrawler-selector").find(".ncx_bar_button_tilte").mouseout(function(){jQuery(this).removeClass("ncx_onhover")});jQuery("#newcrawler-selector").find("#ncx_larger").click(function(){var a=jQuery("#newcrawler-selector").find("#ncx_edit_tpl_tool").data("child");E<a.length&&E++;a=a[E];p(a)||(K(jQuery(a).get(0)),y(jQuery(a).get(0),2,!1))});jQuery("#newcrawler-selector").find("#ncx_smaller").click(function(){var a=jQuery("#newcrawler-selector").find("#ncx_edit_tpl_tool").data("child");0<E&&E--;
a=a[E];p(a)||(K(jQuery(a).get(0)),y(jQuery(a).get(0),2,!1))});jQuery("#newcrawler-selector").find("#ncx_et_state_2").click(function(){I("ncx_et_state_20")});jQuery("#newcrawler-selector").find("#ncx_et_state_3").click(function(){I("ncx_et_state_30")});jQuery("#newcrawler-selector").find("#ncx_et_state_4").click(function(){I("ncx_et_state_40")});jQuery("#newcrawler-selector").find("#ncx_et_state_4").trigger("click");jQuery("#newcrawler-selector").find("#ncx_edit_tpl_tool").h()}
String.prototype.replaceAll=function(a,b){return this.replace(new RegExp(a,"gm"),b)};var L=1,x=!1,z=[],N=null,O=null,P=null,Q=0,qa=0,R=null,U=null;
function V(a,b,c,e){var d=document.getElementById("ncx_message-box");d?(d.innerHTML="",d.style.display="none"):(d=document.createElement("div"),d.innerHTML='<div id="ncx_message-box" style="border-radius: 2px;padding: 5px 15px; font-size: 12px; font-color: #333; font-weight: bold; position: fixed!important; top: 50px; left: 50%; z-index: 2147483500; display: none;"></div>',document.body.appendChild(d.firstChild),d=document.getElementById("ncx_message-box"));"hide"==a?(d.innerHTML="",d.style.display=
"none"):("show"==a?(d.innerHTML=b,d.style.display="block",d.style.marginLeft=-(d.clientWidth/2)+"px"):"fade"==a&&(d.innerHTML=b,d.style.display="block",d.style.marginLeft=-(d.clientWidth/2)+"px",setTimeout(function(){V("hide")},c)),jQuery(document).find("#ncx_message-box").removeClass("message_red"),jQuery(document).find("#ncx_message-box").removeClass("message_green"),jQuery(document).find("#ncx_message-box").removeClass("message_yellow"),"red"==e?jQuery(document).find("#ncx_message-box").addClass("message_red"):
"green"==e?jQuery(document).find("#ncx_message-box").addClass("message_green"):jQuery(document).find("#ncx_message-box").addClass("message_yellow"))}
function ra(){jQuery("#newcrawler").contents().find("body").append('<div id="ncx_cover-container"><div id="ncx_curlCover" class="ncx_curlCover"  style="z-index : 1999999999; filter:Alpha(Opacity=100); -moz-opacity: 1; opacity: 1;  pointer-events:none; text-align: left; background : transparent;top:0;left:0;position:absolute;overflow:hidden;"></div></div>');jQuery("#newcrawler").contents().find("body").css({cursor:"pointer"});document.title="New Crawler\u2122 "+jQuery("#newcrawler").contents().find("title").text();
N=W("webCrawlerId");O=W("siteId");P=W("rulesVerId");var a=jQuery("#newcrawler").contents().height(),b=jQuery("#newcrawler").contents().width();600>b&&(b=980);jQuery("#newcrawler").contents().find("#ncx_curlCover").css({width:b,height:a+8})}
function sa(){jQuery("#newcrawler").contents().find("*").unbind();jQuery("#newcrawler").contents().find("a").unbind("click").click(function(){return!1});jQuery("#newcrawler").contents().find("body").contents().find("*").each(function(){jQuery(this).off()});jQuery("#newcrawler").contents().find("body").contents().find("*").each(function(){this.onclick=function(){return!1};this.onmouseleave=function(){return!1};this.onmousedown=function(){return!1};this.onmouseover=function(){return!1}});jQuery("#newcrawler").contents().find("body").contents().find("*").not("iframe").contents().filter(function(){var a=
3==this.nodeType,b=!1;1<jQuery(this).parent().contents().length&&(b=!0);return a&&b}).wrap("<ncx-text></ncx-text>");jQuery("#newcrawler").contents().find("body").contents().find("*").bind("mouseover",function(a){a=a||window.event;a=a.target||a.srcElement;if("html"!=jQuery(a).get(0).tagName.toLowerCase()&&"ncx_highlightTool"!=jQuery(a).attr("class")&&1==l){ba=1;ca=a;jQuery("#newcrawler").contents().find("#ncx_curlCover .ncx_highlightTool").remove();jQuery("#newcrawler").contents().find("#ncx_curlCover").append("<div id='ncx_traceHighlight_top' class='ncx_highlightTool'></div>");
jQuery("#newcrawler").contents().find("#ncx_curlCover").append("<div id='ncx_traceHighlight_right' class='ncx_highlightTool'></div>");jQuery("#newcrawler").contents().find("#ncx_curlCover").append("<div id='ncx_traceHighlight_bottom' class='ncx_highlightTool'></div>");jQuery("#newcrawler").contents().find("#ncx_curlCover").append("<div id='ncx_traceHighlight_left' class='ncx_highlightTool'></div>");var b=jQuery("#newcrawler").contents().find("#ncx_traceHighlight_top"),c=jQuery("#newcrawler").contents().find("#ncx_traceHighlight_right"),
e=jQuery("#newcrawler").contents().find("#ncx_traceHighlight_bottom"),d=jQuery("#newcrawler").contents().find("#ncx_traceHighlight_left"),f=jQuery(a).offset(),g=jQuery(a).outerWidth(),h=jQuery("#newcrawler").contents().width();g>h&&(g=h-8);r(b,f.left-2,f.top-2,g+4,2,"border-bottom");r(c,f.left+g,f.top,2,jQuery(a).outerHeight(),"border-left");r(e,f.left-2,f.top+jQuery(a).outerHeight(),g+4,2,"border-top");r(d,f.left-2,f.top,2,jQuery(a).outerHeight(),"border-right")}return!1});jQuery("#newcrawler").contents().find("body").contents().find("*").each(function(){jQuery(this).click(function(){E=
0;if(1==ba){var a=ca;jQuery("#ncx_toolbar .ncx-datatypes .active").hasClass("ncx-cron")&&(jQuery("#ncx_toolbar .ncx-datatypes .ncx-cron").removeClass("active"),jQuery("#ncx_toolbar .ncx-cron-config").hide(),jQuery("#ncx_toolbar .ncx-datatypes .ncx-data-dot.ncx-yellow").addClass("active"));jQuery("#ncx_toolbar .ncx-datatypes .active").hasClass("ncx-setting")&&(jQuery("#ncx_toolbar .ncx-datatypes .ncx-setting").removeClass("active"),jQuery("#ncx_toolbar .ncx-setting-config").hide(),jQuery("#ncx_toolbar .ncx-datatypes .ncx-data-dot.ncx-yellow").addClass("active"));
jQuery("#ncx_toolbar .ncx-datatypes .active").hasClass("ncx-pagination")?x=!0:(jQuery("#ncx_toolbar .ncx-setting-config").hide(),jQuery("#ncx_toolbar .ncx-cron-config").hide(),jQuery("#ncx_toolbar .ncx-datatypes .ncx-cron").removeClass("active"),jQuery("#ncx_toolbar .ncx-datatypes .ncx-setting").removeClass("active"),jQuery("#ncx_toolbar .ncx-datatypes .ncx-data-dot.ncx-yellow").addClass("active"),x=!1);K(a);jQuery("#newcrawler").contents().find("#ncx_curlCover").css({"pointer-events":"auto"});y(a,
1,!1)}return!1})})}
function ta(){var a=decodeURIComponent(newcrawler_fetch_url);jQuery("#ncx_toolbar #url").text(a);jQuery("#ncx_toolbar #url").parent().attr("href",a).attr("title",a);jQuery("#ncx_toolbar .ncx-save").click(function(){ua(function(){jQuery("#ncx_toolbar .ncx-cron-config").hide();jQuery("#ncx_toolbar .ncx-setting-config").hide()})});jQuery("#ncx_toolbar .ncx-view").click(function(){null==N||void 0==N||isNaN(N)||(va.v.webCrawlerId=N,wa());jQuery("#ncx_toolview .ncx-content-top-export").hide(100);jQuery(".view-pop").toggle(600);
jQuery("#ncx_toolview").toggle(600,function(){jQuery("#ncx_toolview").is(":visible")?(document.body.parentNode.style.overflow="hidden",jQuery("#ncx-crawlDataLog").show(),U.init(function(){jQuery(window).trigger("resize")}),20==jQuery("#ncx_toolview > .ncx-content-top").find("#ncx-pagination-size").val()&&xa(),jQuery(window).resize(function(){var a=window,c=document,e=c.documentElement,d=c.getElementsByTagName("body")[0],c=(a.innerHeight||e.clientHeight||d.clientHeight)-46,a=(a.innerWidth||e.clientWidth||
d.clientWidth)-50;jQuery("#ncx_toolview").outerWidth(a);jQuery("#ncx_toolview").outerHeight(c);jQuery(".ncx-content-bottom").outerHeight(c-jQuery(".ncx-content-top").outerHeight(!0));jQuery(".logsViewConsoleWindow").outerHeight(jQuery(".ncx-content-bottom").outerHeight(!0)-jQuery("#ncx-crawlDataLog").outerHeight(!0))}),jQuery(window).trigger("resize")):(document.body.parentNode.style.overflow="auto",jQuery("#ncx-crawlDataLog").hide(),U.destory())})});jQuery("#ncx_toolbar .ncx-js .isJavaScript").click(function(){ua(function(){top.window.location.href=
R})});jQuery("#ncx_toolview .ncx-refresh").click(function(){xa()});jQuery("#ncx_toolview .ncx-export").click(function(){jQuery("#ncx_toolview .ncx-export-window").is(":visible")?jQuery("#ncx_toolview .ncx-export-window").hide(100):jQuery("#ncx_toolview .ncx-content-top-export").toggle(100)});jQuery("#ncx_toolview .ncx-export-plotly").click(function(){var a,c={};a=[];for(var e=document.getElementById("ncx_data_list"),d=e.rows[0],f=d.cells.length,g=0;g<f;g+=1){var h=d.cells[g];a.push(h.innerHTML)}d=
e.rows.length;for(f=1;f<d;f+=1)for(var g=e.rows[f],k=g.cells.length,m=0;m<k;m+=1){var h=g.cells[m],t=a[m],h=h.innerHTML;if(null==c[t]||void 0==c[t])c[t]={data:[]};c[t].data.push(h)}a={cols:c};c=jQuery('<div id="hiddenform" style="display:none;"><form action="https://plot.ly/datagrid" method="post" target="_blank" accept-charset="utf-8"><input type="text" name="data" /></form></div>').appendTo("body");a=JSON.stringify(a);c.find("input").val(a);c.find("form").submit();c.remove()});jQuery("#ncx_toolview .ncx-export-coding").click(function(){if(null!=
O&&""!=O){var a=newcrawler_app_url+"api/data/export?siteId="+O+"&pageNum="+(Q+1)+"&type=json";jQuery("#ncx_toolview .ncx-export-coding").attr("href",a)}});jQuery("#ncx_toolview .ncx-export-window .close").click(function(){jQuery("#ncx_toolview .ncx-content-top").show();jQuery("#ncx_toolview .ncx-content-bottom").show();jQuery("#ncx_toolview .ncx-export-window").hide(400)});jQuery("#ncx_toolview .ncx-export-rss.ncx-export-icon").click(function(){jQuery("#ncx_toolview .ncx-content-top-export").hide();
jQuery("#ncx_toolview .ncx-content-top").hide();jQuery("#ncx_toolview .ncx-content-bottom").hide();jQuery("#ncx_toolview .ncx-export-window-rss").toggle(600,function(){if(jQuery("#ncx_toolview .ncx-export-window-rss").is(":visible")&&(jQuery("#ncx_toolview .ncx-export-window-rss .title").text(),null!=O&&""!=O)){X.crawlDataExportService.query(function(a,b){if(b){var d="System errors.";b.b&&(d=b.b);V("fade",d,3E3,"red")}else a&&(d=eval(a),ya(d))},N,O,"rss");var a=newcrawler_app_url+"api/data/export?siteId="+
O+"&pageNum="+(Q+1)+"&type=rss";jQuery("#ncx_toolview .ncx-export-window-rss .ncx-btn-rss").attr("href",a)}})});jQuery("#ncx_toolview .ncx-export-wordpress.ncx-export-icon").click(function(){jQuery("#ncx_toolview .ncx-content-top-export").hide();jQuery("#ncx_toolview .ncx-content-top").hide();jQuery("#ncx_toolview .ncx-content-bottom").hide();jQuery("#ncx_toolview .ncx-export-window-wordpress").toggle(600,function(){if(jQuery("#ncx_toolview .ncx-export-window-wordpress").is(":visible")){var a=jQuery("#ncx_toolview .ncx-export-window-wordpress .title").text();
null!=O&&""!=O&&X.dataDeployService.queryByXpath(function(a,b){if(b){var d="System errors.";b.b&&(d=b.b);V("fade",d,3E3,"red")}else a&&(d=eval("("+a+")"),za(d))},N,O,a)}})});jQuery("#ncx_toolview .ncx-export-db.ncx-export-icon").click(function(){jQuery("#ncx_toolview .ncx-content-top-export").hide();jQuery("#ncx_toolview .ncx-content-top").hide();jQuery("#ncx_toolview .ncx-content-bottom").hide();jQuery("#ncx_toolview .ncx-export-window-db").toggle(600,function(){if(jQuery("#ncx_toolview .ncx-export-window-db").is(":visible")){var a=
jQuery("#ncx_toolview .ncx-export-window-db .title").text();null!=O&&""!=O&&X.dataDeployService.queryByXpath(function(a,b){if(b){var d="System errors.";b.b&&(d=b.b);V("fade",d,3E3,"red")}else a&&(d=eval("("+a+")"),Aa(d))},N,O,a)}})});jQuery("#ncx_toolview .ncx-run").click(function(){var a=jQuery("#ncx_toolbar #ncx-cron-id").val();X.scheduleService.execute(function(a,b){if(b){var d="System errors.";b.b&&(d=b.b);V("fade",d,3E3,"red")}else a&&(V("fade","Task running...",3E3),setTimeout(function(){U.init(function(){jQuery(window).trigger("resize")})},
2E3))},N,O,a)});jQuery("#ncx_toolview .ncx-download").click(function(){jQuery("#ncx_data_list").table2excel({name:"NewCrawler Data",filename:"NewCrawlerData"})});jQuery("#ncx_toolbar #ncx-charset-select").change(function(){var a=jQuery("#ncx_toolbar #ncx-charset-select").val();null==a||""==a?(jQuery("#ncx_toolbar #ncx-charset").show(),jQuery("#ncx_toolbar #ncx-charset").val("")):(jQuery("#ncx_toolbar #ncx-charset").hide(),jQuery("#ncx_toolbar #ncx-charset").val(a))});la()}
function la(){jQuery("#ncx_toolbar .ncx-datatypes .ncx-data-dot .ncx-delete-datatype").unbind("click").click(function(){var a=jQuery(this).parent().attr("title"),b=jQuery(this).parent().attr("lang"),c=[];c.push(z[0]);for(var e=1,d=z.length;e<d;e++)b!=z[e].index&&c.push(z[e]);z=c;jQuery(this).parent().remove();void 0==jQuery("#ncx_toolbar .ncx-datatypes .ncx-label.finished")&&jQuery("#ncx_toolbar .save").attr("disabled",!0);Ba(a)});jQuery("#ncx_toolbar .ncx-datatypes .ncx-label.finished").unbind("mouseout").mouseout(function(){jQuery(this).find(".ncx-delete-datatype").hide();
jQuery(this).find(".ncx-delete-datatype").removeClass("visible")});jQuery("#ncx_toolbar .ncx-datatypes .ncx-data-dot").unbind("click").click(function(){if(jQuery(this).hasClass("ncx-pagination")||jQuery(this).hasClass("ncx-cron")||jQuery(this).hasClass("ncx-setting")){var a=jQuery(this).hasClass("active");a||(jQuery("#ncx_toolbar .ncx-data-dot").each(function(){jQuery(this).removeClass("active")}),jQuery(this).addClass("active"));jQuery(this).hasClass("ncx-cron")?jQuery("#ncx_toolbar .ncx-cron-config").is(":visible")?
(jQuery("#ncx_toolbar .ncx-cron-config").hide(),jQuery(this).removeClass("active")):jQuery("#ncx_toolbar .ncx-cron-config").show():jQuery("#ncx_toolbar .ncx-cron-config").hide();jQuery(this).hasClass("ncx-setting")?jQuery("#ncx_toolbar .ncx-setting-config").is(":visible")?(jQuery("#ncx_toolbar .ncx-setting-config").hide(),jQuery(this).removeClass("active")):jQuery("#ncx_toolbar .ncx-setting-config").show():jQuery("#ncx_toolbar .ncx-setting-config").hide()}else jQuery(this).hasClass("ncx-label")&&
!jQuery(this).hasClass("finished")&&(a=jQuery(this).hasClass("active"),a||(jQuery(this).addClass("active"),jQuery("#ncx_toolbar .ncx-datatypes .ncx-pagination").removeClass("active"),jQuery("#ncx_toolbar .ncx-datatypes .ncx-cron").removeClass("active"),jQuery("#ncx_toolbar .ncx-datatypes .ncx-setting").removeClass("active"),jQuery("#ncx_toolbar .ncx-cron-config").hide(),jQuery("#ncx_toolbar .ncx-setting-config").hide()));a=jQuery(this).attr("lang");if(null!=a&&""!=a&&void 0!=a)for(var b in z)if(a==
z[b].index){var c=z[b].c;z[b].a.slice(0);for(var c=c.replace(":nth-of-type(*)",""),c=jQuery("#newcrawler").contents().find(c),e=c.length,d=0;d<e;d++){var f=c[d];if(0==d){var g=jQuery(f).offset().top,f=jQuery(f).outerHeight(),h=0;65>jQuery("#newcrawler").contents().outerHeight()-g-f?(h=g+1,0>h&&(h=0)):h=g+f+3;jQuery("#newcrawler").contents().scrollTop(h-300)}}}});jQuery("#ncx_toolbar .ncx-datatypes .ncx-data-dot").unbind("mouseover").mouseover(function(){jQuery(this).hasClass("ncx-label")&&jQuery(this).hasClass("finished")&&
(jQuery(this).find(".ncx-delete-datatype").show(),jQuery(this).find(".ncx-delete-datatype").addClass("visible"));w();var a=jQuery(this).attr("lang");if(null!=a&&""!=a&&void 0!=a)for(var b in z)if(a==z[b].index){var c=z[b].c;z[b].a.slice(0);for(var c=c.replace(":nth-of-type(*)",""),c=jQuery("#newcrawler").contents().find(c),e=c.length,d=0;d<e;d++)v(c[d],!1,0,null)}})}
function W(a){for(var b=window.location.search.substring(1).split("&"),c=0;c<b.length;c++){var e=b[c].split("=");if(e[0]==a)return e[1]}return""}
function Ca(a){if(null!=N&&void 0!=N&&!isNaN(N)){jQuery("#ncx_toolbar .save").attr("disabled",!0);z[0]={};var b=null;if(null!=O&&""!=O&&null!=P&&""!=P&&(jQuery("#ncx_toolbar #ncx-headers").val(""),jQuery("#ncx_toolbar #ncx-charset-select").val(""),jQuery("#ncx_toolbar #ncx-charset-select").change(),urlString=newcrawler_server_url+"member/rules/query?webCrawlerId="+N+"&siteId="+O+"&rulesVerId="+P,jQuery.ajax({type:"GET",dataType:"json",url:urlString,async:!1,success:function(a){b=a},error:function(a,
b,c){console.log(c);jQuery("#ncx_toolbar .ncx-toolbar-section.msg").html("<div><span style='color:red;'>System errors.</span></div>");setTimeout(function(){jQuery("#ncx_toolbar .ncx-toolbar-section.msg").html("")},3E3)}}),null!=b&&""!=b)){var c=b.cronId,e=b.cronDate,d=b.cronTime,f=b.pluginId,g=b.isJs,h=b.charset,k=b.headers;jQuery("#ncx_toolbar .ncx-js input[type=checkbox][name='ncx-isJs']").attr("checked",g);jQuery("#ncx_toolbar .ncx-js #ncx-pluginId").val(f);jQuery("#ncx_toolbar #ncx-cron-id").val(c);
jQuery("#ncx_toolbar #ncx-cron-date").val(e);jQuery("#ncx_toolbar #ncx-cron-time").val(d);jQuery("#ncx_toolbar #ncx-headers").val(k);jQuery("#ncx_toolbar #ncx-charset-select").val(h);jQuery("#ncx_toolbar #ncx-charset-select").change();var b=b.rules,m;for(m in b)isNaN(m)||"csspath"!=b[m].searchMode||(c=b[m].id,e=b[m].name,d=b[m].selectExpress,f=b[m].selectType,g=b[m].selectAttr,h=b[m].labelType,k=ka(d),"2"==h?M(c,0,e,d,k,f,!0,g):M(c,L,e,d,k,f,!1,g))}a&&a()}}
function Da(a){jQuery("#ncx_toolview .ncx-export-window").each(function(){if(jQuery(this).is(":visible")){var b=jQuery(this).find(".title").text(),c="";if(jQuery(this).hasClass("ncx-export-window-wordpress")){var e=jQuery(this).find("input[name=__sign]").val(),d=jQuery(this).find("input[name=__url]").val();null!=d&&""!=d&&(d="http://"+d+"/?__ta=post");var f=jQuery(this).find("select[name=post_status]").val(),g=jQuery(this).find("input[name=access_password]").val(),h=jQuery(this).find("input[name=isUploadImage]").is(":checked"),
k="";h&&(k=jQuery(this).find("input[name=isUploadImage]").parent().find("input[name=param]").val(),h="Y");null!=e&&""!=e&&(c="__sign="+e);null!=f&&""!=f&&(""!=c&&(c+="&"),c+="postStatus="+f);null!=g&&""!=g&&(""!=c&&(c+="&"),c+="accessword="+g);jQuery(this).find(".fieldMap input[name=param]").each(function(){var a=this.value,b=jQuery(this).parent().parent().find("select.allFileds").val();null!=b&&""!=b&&(""!=c&&(c+="&"),c+=a+"="+b)});a.deployUrl=d;a.isUploadImage=h;a.imageLabels=k}else if(jQuery(this).hasClass("ncx-export-window-db")){var e=
jQuery(this).find("select[name=dbType]").val(),d=jQuery(this).find("input[name=dbHost]").val(),f=jQuery(this).find("input[name=dbPort]").val(),g=jQuery(this).find("input[name=dbName]").val(),h=jQuery(this).find("input[name=dbUser]").val(),k=jQuery(this).find("input[name=dbPassword]").val(),m=jQuery(this).find("select[name=dbCharset]").val();jQuery(this).find(".fieldMap > div:not(.temp)").find("input[name=param]").each(function(){var a=this.value,b=jQuery(this).parent().find("input[name=labelName]").val();
null!=b&&""!=b&&(""!=c&&(c+="&"),c+=a+"="+b)});a.dbType=e;a.dbHost=d;a.dbPort=f;a.dbName=g;a.dbUser=h;a.dbPassword=k;a.dbCharset=m}else if(jQuery(this).hasClass("ncx-export-window-rss")){var t={};jQuery(this).find(".fieldMap input[name=param]").each(function(){var a=this.value,b=jQuery(this).parent().parent().find("select.allFileds").val();if(void 0==b||null==b)b="";t[a]=b});e=$.toJSON(t);a.export2RSS=e}a.deployParams=c;a.deployName=b}});return a}
function ya(a){var b="",c;for(c in a)if(!isNaN(c)){var e=a[c].name,b=a[c].value,e=jQuery("#ncx_toolview .ncx-export-window-rss").find("input[name='param'][value='"+e+"']");jQuery(e).parent().parent().find("select.allFileds").val(b)}}
function za(a){var b=a.deployUrl,c=a.deployParams;"Y"==a.isUploadImage&&jQuery("#ncx_toolview .ncx-export-window-wordpress").find("input[name=isUploadImage]").attr("checked",!0);0==b.indexOf("http://")&&(b=b.substring(7));-1!=b.indexOf("/?__ta=post")&&(b=b.substring(0,b.indexOf("/?__ta=post")));jQuery("#ncx_toolview .ncx-export-window-wordpress").find("input[name=__url]").val(b);if(null!=c&&""!=c)for(a=c.split("&"),b=0,c=a.length;b<c;b++){var e=a[b].split("="),d=e[0],e=e[1];"__sign"==d?jQuery("#ncx_toolview .ncx-export-window-wordpress").find("input[name='__sign']").val(e):
"postStatus"==d?jQuery("#ncx_toolview .ncx-export-window-wordpress").find("select[name='post_status']").val(e):"accessword"==d?jQuery("#ncx_toolview .ncx-export-window-wordpress").find("input[name='access_password']").val(e):(d=jQuery("#ncx_toolview .ncx-export-window-wordpress").find("input[name='param'][value='"+d+"']"),jQuery(d).parent().parent().find("select.allFileds").val(e))}}
function Aa(a){var b=a.deployParams,c=a.dbHost,e=a.dbPort,d=a.dbName,f=a.dbUser,g=a.dbPassword,h=a.dbCharset;a=a.dbTable;jQuery("#ncx_toolview .ncx-export-window-db").find("input[name='dbHost']").val(c);jQuery("#ncx_toolview .ncx-export-window-db").find("input[name='dbPort']").val(e);jQuery("#ncx_toolview .ncx-export-window-db").find("input[name='dbName']").val(d);jQuery("#ncx_toolview .ncx-export-window-db").find("input[name='dbUser']").val(f);jQuery("#ncx_toolview .ncx-export-window-db").find("input[name='dbPassword']").val(g);
jQuery("#ncx_toolview .ncx-export-window-db").find("select[name='dbCharset']").val(h);jQuery("#ncx_toolview .ncx-export-window-db").find("input[name='dbTable']").val(a);if(null!=b&&""!=b)for(b=b.split("&"),c=0,e=b.length;c<e;c++)f=b[c].split("="),d=f[0],f=f[1],f=jQuery("#ncx_toolview .ncx-export-window-db").find("input[name='labelName'][value='"+f+"']"),jQuery(f).parent().find("input[name='param']").val(d)}
function ua(a){var b=newcrawler_server_url,c=[],e;for(e in z){var d=z[e].id,f=z[e].index,g=z[e].name,h=z[e].c,k=z[e].g,m=z[e].f;if(null!=g&&""!=g&&null!=h&&""!=h){var t="1";0==f&&(t="2");c.push({id:d,name:g,selectExpress:h,selectAttr:m,selectType:k,labelType:t})}}jQuery("#ncx_toolbar .ncx-toolbar-section.msg").html("<div class='loading'></div>");e="";null!=c&&0<c.length&&(e=JSON.stringify(c));c=jQuery("#ncx_toolbar #ncx-cron-id").val();d=jQuery("#ncx_toolbar #ncx-cron-date").val();f=jQuery("#ncx_toolbar #ncx-cron-time").val();
g="";h=!1;jQuery("#ncx_toolbar .ncx-js input[type=checkbox][name='ncx-isJs']").is(":checked")&&(h=!0,g=jQuery("#ncx_toolbar .ncx-js #ncx-pluginId").val());k=jQuery("#ncx_toolbar #ncx-charset").val();m=jQuery("#ncx_toolbar #ncx-headers").val();urlString=b+"member/rules/save";b={webCrawlerId:N,siteId:O,rulesVerId:P,rulesJson:e,url:jQuery("#ncx_toolbar #url").text(),cronId:c,cronDate:d,cronTime:f,isJs:h,pluginId:g,charset:k,headers:m};b=Da(b);jQuery.ajax({type:"POST",data:b,url:urlString,async:!0,dataType:"json",
error:function(a,b,c){console.log(c);jQuery("#ncx_toolbar .ncx-toolbar-section.msg").html("<div><span style='color:red;'>System errors.</span></div>");setTimeout(function(){jQuery("#ncx_toolbar .ncx-toolbar-section.msg").html("")},3E3)},success:function(b){var c=b.msg;if("1"==b.code){var d=b.cronId;null!=d&&void 0!=d&&"undefined"!=d&&jQuery("#ncx_toolbar #ncx-cron-id").val(d);var d=b.isNew,e=b.pluginId;null!=e&&void 0!=e&&"undefined"!=e&&jQuery("#ncx_toolbar .ncx-js #ncx-pluginId").val(e);null!=b.siteId&&
""!=b.siteId&&(O=b.siteId,"true"==d&&(R=R+"&siteId="+O));null!=b.rulesVerId&&""!=b.rulesVerId&&(P=b.rulesVerId,"true"==d&&(R=R+"&rulesVerId="+P));if(newcrawler_refresh&&null!=newcrawler_refresh&&void 0!=newcrawler_refresh&&"undefined"!=newcrawler_refresh)try{newcrawler_refresh()}catch(f){console.log(f.description||f)}c="<span style='color:green;'>"+c+"</span>";a&&a();"true"==d&&(top.window.location.href=R)}else c="<span style='color:red;'>"+c+"</span>";jQuery("#ncx_toolbar .ncx-toolbar-section.msg").html("<div>"+
c+"</div>");setTimeout(function(){jQuery("#ncx_toolbar .ncx-toolbar-section.msg").html("")},3E3)}})}
function xa(){jQuery("#ncx_toolview > .ncx-content-top").find(".loading").show();jQuery("#ncx_toolview > .ncx-content-top > .ncx-content-top-data table").empty();for(var a="",b=z.length,c=1;c<b;c++)var e=z[c].name,a=a+"<th>",a=a+e,a=a+"</th>";""!=a&&jQuery("<tr><th>index</th>"+a+"<th>status</th><th>createDate</th></tr>").appendTo(jQuery("#ncx_toolview > .ncx-content-top > .ncx-content-top-data table"));Q=0;Ea();var d=jQuery("#ncx_toolview > .ncx-content-top").find("#ncx-pagination-size").val();X.crawlDataService.count(function(a){qa=
a;var b=nc.i18n("res.page.prev"),c=nc.i18n("res.page.next");jQuery("#ncx_toolview > .ncx-content-top").find("#ncx-pagination").pagination(a,{num_edge_entries:2,num_display_entries:5,current_page:0,callback:function(a){Q=a;Ea()},items_per_page:d,prev_text:b,next_text:c})},N,O)}
function Ea(){var a=Q,b=z.length,c=jQuery("#ncx_toolview > .ncx-content-top > .ncx-content-top-data table");Fa(c);for(var e=jQuery("#ncx_toolview > .ncx-content-top").find("#ncx-pagination-size").val(),c=a*e,e=e/20,d=0,f=0,g=0;g<e;g++){var h=c+20*g;if(h>qa)break;var k=1;d++;X.crawlDataService.query(function(c){f++;c=eval(c);if(null!=c&&0<c.length){Q=a;for(var d in c)if(!isNaN(d)){for(var e=eval(c[d].data),g="<tr><td>"+k+"</td>",h=c[d].createDate,m=1==c[d].status?'<span class="label-info bg-green">'+
nc.i18n("res.published")+"</span>":"",Y=1;Y<b;Y++){var Z=z[Y].name,pa=!1,aa;for(aa in e)if(Z==e[aa].name){Z=e[aa].value;g+="<td>";g+=Z;g+="</td>";pa=!0;break}pa||(g+="<td></td>")}g+="<td>"+m+"</td><td>"+h+"</td></tr>";e=jQuery(g);e.find("td").click(function(){jQuery(this).attr("title",jQuery(this).text())});e.appendTo(jQuery("#ncx_toolview > .ncx-content-top > .ncx-content-top-data table"));k++}}else{var g;jQuery("<tr><td  style='border: none;'>Not Found Data.</td>").appendTo(jQuery("#ncx_toolview > .ncx-content-top > .ncx-content-top-data table"))}},
N,{javaClass:"com.soso.web.jsonrpc.bo.CrawlDataBo",siteId:O,startIndex:h,size:20,searchStarttime:null,searchEndtime:null})}var m=setInterval(function(){d===f&&(jQuery("#ncx_toolview > .ncx-content-top").find(".loading").hide(),clearInterval(m))},3E3)}function Fa(a){a=a.get(0);for(var b=a.rows.length-1;0<b;b--)a.deleteRow(b)}
function Ga(){sa();ra();R=top.window.location.href;jQuery("iframe[name=newcrawler]").height(jQuery(window).height()-46);jQuery(window).resize(function(){jQuery("iframe[name=newcrawler]").height(jQuery(window).height()-46)});jQuery(window).css("overflow","hidden");try{ta();var a=document.getElementById("newcrawler").contentWindow.getNewCrawlerUserAgent(),b=document.getElementById("newcrawler").contentWindow.getNewCrawlerCharset();jQuery("#ncx_toolbar #ncx-headers").val(a);jQuery("#ncx_toolbar #ncx-charset-select").val(b);
jQuery("#ncx_toolbar #ncx-charset-select").change();Ca(function(){jQuery(document).on("mousemove",function(){});jQuery(".ncx_toolbar_cover").remove();Ha()})}catch(c){}}
function Ha(){jQuery("#ncx_toolview .ncx-export-content select.allFileds").each(function(){jQuery(this).find("option:gt(0)").remove()});jQuery("#ncx_toolview .ncx-export-window-db .ncx-export-content .fieldMap > div:not(.temp)").remove();for(var a in z)if(0!=z[a].index){var b=z[a].name,c=z[a].c;null!=b&&""!=b&&null!=c&&""!=c&&(jQuery("#ncx_toolview .ncx-export-window-wordpress .ncx-export-content select.allFileds").append("<option value='${"+b+"}'>"+b+"</option>"),jQuery("#ncx_toolview .ncx-export-window-rss .ncx-export-content select.allFileds").append("<option value='"+
b+"'>"+b+"</option>"),c=jQuery("#ncx_toolview .ncx-export-window-db .ncx-export-content .fieldMap .temp").clone(),c.removeClass("temp"),c.show(),c.find(".labelName").text(b),c.find("input[name=labelName]").val("${"+b+"}"),c.find("input[name=param]").val(b),jQuery("#ncx_toolview .ncx-export-window-db .ncx-export-content .fieldMap").append(c))}}
function Ba(a){jQuery("#ncx_toolview .ncx-export-window-wordpress .ncx-export-content select.allFileds").each(function(){var b=jQuery(this);b.find("option[value='${"+a+"}']").is(":checked")&&b.val("");b.find("option[value='${"+a+"}']").remove()});jQuery("#ncx_toolview .ncx-export-window-db .ncx-export-content .fieldMap input[name=param][value="+a+"]").parent().remove();jQuery("#ncx_toolview .ncx-export-window-rss .ncx-export-content select.allFileds").each(function(){var b=jQuery(this);b.find("option[value='"+
a+"']").is(":checked")&&b.val("");b.find("option[value='"+a+"']").remove()})}function Ia(){V("fade","Completed.",3E3,"green");Ga()}var X,va,wa;
jQuery(document).ready(function(){jQuery("#ncx_toolbar #ncx-cron-time").clockpicker({placement:"bottom",align:"top",autoclose:!0});jQuery("#ncx_toolbar #ncx-cron-date").datetimepicker({timepicker:!1,validateOnBlur:!1,closeOnDateSelect:!0,format:"Y-m-d"});JSONRpcClient.profile_async=!0;JSONRpcClient.max_req_active=2;JSONRpcClient.requestId=1;X=jsonrpc=new JSONRpcClient("../JSON-RPC/MEMBER");va=logsViewConsole;logsViewConsole.fn.init();wa=function(){jQuery(".logsViewConsole").click()};var a=getUrlParameter("webCrawlerId"),
b=getUrlParameter("siteId");U=new crawlDataLog({tableId:"ncx-crawlDataLog",listTableId:"ncx-crawlDataLogList",PER_PAGE_ITEMS:5,ITEMS_COUNT:0,cur_page:0,webCrawlerId:a,siteId:b});a=jQuery("#newcrawler")[0];a.attachEvent?a.attachEvent("onload",function(){Ia()}):a.onload=function(){Ia()};V("show","Loading...");a.src=newcrawler_url});
(function(a){a.fn.h=function(){var b={handle:".ncx_et_bar"},b=a.extend({handle:"",cursor:"move"},b);(""===b.handle?this:this.find(b.handle)).css("cursor",b.cursor).on("mousedown",function(c){var e=""===b.handle?a(this).addClass("draggable"):a(this).addClass("active-handle").parent().addClass("draggable"),d=e.css("z-index"),f=e.outerHeight(),g=e.outerWidth(),h=e.offset().top+f-c.pageY,k=e.offset().left+g-c.pageX;e.css("z-index",2147483488).parents().on("mousemove",function(b){a(".draggable").offset({top:b.pageY+
h-f,left:b.pageX+k-g}).on("mouseup",function(){a(this).removeClass("draggable").css("z-index",d)})});c.preventDefault()}).on("mouseup",function(){""===b.handle?a(this).removeClass("draggable"):a(this).removeClass("active-handle").parent().removeClass("draggable")}).on("mouseout",function(){""===b.handle?a(this).removeClass("draggable"):a(this).removeClass("active-handle").parent().removeClass("draggable")})}})(jQuery);
