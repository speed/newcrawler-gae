var l=1,aa=0,ba=null,n=0;function q(b){return null==b||"null"==b||""==b||void 0==b||"undefined"==b||[]==b||void 0==jQuery(b).get(0).tagName}function r(b,a){b.append(a)}function u(b,a,d,e,c,f){b.css({left:a,top:d,width:e,height:c});b.css({"z-index":2999999999,position:"absolute","background-color":"#facd93"});b.css(f,"1px dashed #000")}function v(b,a,d,e,c){b.css({left:a,top:d,width:e,height:c});b.css({"z-index":99999,position:"absolute","background-color":"#000",opacity:.5})}
function fa(b){var a="#F9AEAE #F1C194 #F3E13B #CEF57B #9CF994 #75D8BA #55C5F5 #A7A5E4 #D291FF #FF91D5 #EBD2D6".split(" "),d=a.length;b>=d&&(b=d-1);return a[b]}
function w(b,a,d,e){n+=1;var c="";a&&(c="<div class='ncx_selector' style='background-color:"+e+"; position: absolute; height: 15px; width: 35px;'><a class='ncx-highlight-button ncx-accept-highlight' lang='"+d+"' style='background: url(\""+newcrawler_server_url+"static/xpath/v2/icon-highlight-accept.svg\") no-repeat 50% 50%;background-size: 10px 10px;right: 0px;padding-right: 10px;display: inline-block;cursor: pointer!important;height: 12px;width: 12px;opacity: .4;position: absolute;margin-top: 1px;'></a><a class='ncx-highlight-button ncx-reject-highlight' lang='"+d+
"' style='background: url(\""+newcrawler_server_url+"static/xpath/v2/icon-highlight-reject.svg\") no-repeat 50% 50%;background-size: 10px 10px;right: 15px;padding-right: 10px;display: inline-block;cursor: pointer!important;height: 12px;width: 12px;opacity: .4;position: absolute;margin-top: 1px;'></a></div>");jQuery("#newcrawler").contents().find("#ncx_cover-container").append("<div id='ncx_traceHighlight_top_"+n+"' class='ncx_highlightTool'></div>");jQuery("#newcrawler").contents().find("#ncx_cover-container").append("<div id='ncx_traceHighlight_right_"+
n+"' class='ncx_highlightTool'></div>");jQuery("#newcrawler").contents().find("#ncx_cover-container").append("<div id='ncx_traceHighlight_bottom_"+n+"' class='ncx_highlightTool'>"+c+"</div>");jQuery("#newcrawler").contents().find("#ncx_cover-container").append("<div id='ncx_traceHighlight_left_"+n+"' class='ncx_highlightTool'></div>");a=jQuery("#newcrawler").contents().find("#ncx_traceHighlight_top_"+n+"");e=jQuery("#newcrawler").contents().find("#ncx_traceHighlight_right_"+n+"");var c=jQuery("#newcrawler").contents().find("#ncx_traceHighlight_bottom_"+
n+""),f=jQuery("#newcrawler").contents().find("#ncx_traceHighlight_left_"+n+"");d=jQuery(b).offset();var g=jQuery(b).outerWidth();b=jQuery(b).outerHeight();var h=jQuery("#newcrawler").contents().width();g>h&&(g=h-8);u(a,d.left-2,d.top-2,g+4,2,"border-bottom");u(e,d.left+g,d.top,2,b,"border-left");u(c,d.left-2,d.top+b,g+4,2,"border-top");u(f,d.left-2,d.top,2,b,"border-right");jQuery("#newcrawler").contents().find("#ncx_curlCover").unbind("click").click(function(){x()})}
function ga(b){jQuery("#newcrawler").contents().find("#ncx_cover-container .ncx_highlightTool").remove();var a=jQuery(b).offset().top,d=jQuery(b).offset().left,e=jQuery(b).outerWidth(),c=jQuery(b).outerHeight(),f=jQuery("#newcrawler").contents().outerHeight(),g=jQuery("#newcrawler").contents().outerWidth();e>g+8&&(e=g);r(jQuery("#newcrawler").contents().find("#ncx_cover-container"),"<div id='ncx_highlightCover_top' class='ncx_highlightTool'></div>");r(jQuery("#newcrawler").contents().find("#ncx_cover-container"),
"<div id='ncx_highlightCover_right' class='ncx_highlightTool'></div>");r(jQuery("#newcrawler").contents().find("#ncx_cover-container"),"<div id='ncx_highlightCover_bottom' class='ncx_highlightTool'></div>");r(jQuery("#newcrawler").contents().find("#ncx_cover-container"),"<div id='ncx_highlightCover_left' class='ncx_highlightTool'></div>");var h=jQuery("#newcrawler").contents().find("#ncx_highlightCover_top"),k=jQuery("#newcrawler").contents().find("#ncx_highlightCover_right"),m=jQuery("#newcrawler").contents().find("#ncx_highlightCover_bottom"),
p=jQuery("#newcrawler").contents().find("#ncx_highlightCover_left");v(h,0,0,g+8,a-3);v(k,d+3+e,a-3,g-d-3-e+8,c+6);v(m,0,a+3+c,g+8,f-a-c+155);v(p,0,a-3,d-3,c+6);l=0;r(jQuery("#newcrawler").contents().find("#ncx_cover-container"),"<div id='ncx_editHighlight_top' class='ncx_highlightTool'></div>");r(jQuery("#newcrawler").contents().find("#ncx_cover-container"),"<div id='ncx_editHighlight_right' class='ncx_highlightTool'></div>");r(jQuery("#newcrawler").contents().find("#ncx_cover-container"),"<div id='ncx_editHighlight_bottom' class='ncx_highlightTool'></div>");
r(jQuery("#newcrawler").contents().find("#ncx_cover-container"),"<div id='ncx_editHighlight_left' class='ncx_highlightTool'></div>");a=jQuery("#newcrawler").contents().find("#ncx_editHighlight_top");d=jQuery("#newcrawler").contents().find("#ncx_editHighlight_right");c=jQuery("#newcrawler").contents().find("#ncx_editHighlight_bottom");f=jQuery("#newcrawler").contents().find("#ncx_editHighlight_left");g=jQuery(b).offset();u(a,g.left-2,g.top-2,e+4,2,"border-bottom");u(d,g.left+e,g.top,2,jQuery(b).outerHeight(),
"border-left");u(c,g.left-2,g.top+jQuery(b).outerHeight(),e+4,2,"border-top");u(f,g.left-2,g.top,2,jQuery(b).outerHeight(),"border-right");jQuery("#newcrawler").contents().find("#ncx_cover-container .ncx_highlightTool").unbind("click").click(function(){x()})}
function x(){jQuery("#newcrawler").contents().find("#ncx_curlCover .ncx_highlightTool").remove();jQuery("#newcrawler").contents().find("#ncx_cover-container .ncx_highlightTool").remove();jQuery("#newcrawler-selector").find("#ncx_edit_tpl_tool").remove();l=1;jQuery("#newcrawler").contents().find("#ncx_curlCover").css({"pointer-events":"none"});z||(jQuery("#ncx_toolbar .ncx-datatypes .active:not(.finished) .ncx-count").text("0"),jQuery("#ncx_toolbar .ncx-datatypes .active:not(.finished) .ncx-count").attr("lang",
"0"),jQuery("#ncx_toolbar .ncx-datatypes .active.finished .ncx-count").text(jQuery("#ncx_toolbar .ncx-datatypes .active.finished .ncx-count").attr("lang")))}
function A(b,a,d){if(z){B=null;for(var e=C.length,c=e-1;0<c;c--)if("a"==C[c]||0==C[c].indexOf("a:")){for(var f=[],e=c,g=0;g<=e;g++)f[g]=C[g];c=f.join("");c=c.replace(":nth-of-type(*)","");b=jQuery("#newcrawler").contents().find(c)[0];C=f.slice(0);B=f.slice(0);break}if(null==B){x();return}}if(!d){c=f=0;for(e=B.length;c<e;c++)-1!=B[c].indexOf(":nth-of-type(*)")&&f++;1>=f&&(d=!0)}jQuery("#newcrawler").contents().find("#ncx_curlCover .ncx_highlightTool").remove();jQuery("#newcrawler").contents().find("#ncx_cover-container .ncx_highlightTool").remove();
var h=null,k=0;if(!z&&1<D.length){h=D[1].a;c=1;for(e=D.length;c<e;c++)for(g=0,f=D[c].a.length;g<f;g++)-1!=D[c].a[g].indexOf(":nth-of-type(*)")&&(h=D[c].a);k=h.length}f=0;if(!d)for(c=0,e=B.length;c<e;c++)if(-1!=B[c].indexOf(":nth-of-type(*)")){if(null!=h)if(k>c){if(-1==h[c].indexOf(":nth-of-type(*)")){B[c]=C[c];continue}}else{B[c]=C[c];continue}f++}d=!1;if(0<f)d=!0,jQuery("#newcrawler-selector").find("#ncx_edit_tpl_tool").remove(),a=l=1;else{ga(b);1===a?ia(b):ja(b);c=B.join("");jQuery("#newcrawler-selector").find("#ncx_copy_xpath_text").text(c);
e=jQuery(b).get(0);jQuery("#newcrawler-selector").find("select[name='ncx_attr']").empty();jQuery("#newcrawler-selector").find("select[name='ncx_attr']").append('<option value=""></option>');f=!1;c=0;h=e.attributes;for(k=h.length;c<k;c++)f=h[c].nodeName.toLowerCase(),jQuery("#newcrawler-selector").find("select[name='ncx_attr']").append('<option value="'+f+'">'+f+"</option>"),f=!0;f?(jQuery("#newcrawler-selector").find("input[name='ncx_selectType'][value='@ATTR']").attr("disabled",!1),jQuery("#newcrawler-selector").find("select[name='ncx_attr']").attr("disabled",
!1)):(jQuery("#newcrawler-selector").find("input[name='ncx_selectType'][value='@ATTR']").attr("disabled",!0),jQuery("#newcrawler-selector").find("select[name='ncx_attr']").attr("disabled",!0));c=jQuery("#ncx_toolbar .ncx-datatypes .active").attr("title");if(f&&("img"==e.tagName.toLowerCase()||"a"==e.tagName.toLowerCase()&&"Link"==c||z))if("img"==e.tagName.toLowerCase())jQuery("#newcrawler-selector").find("input[name='ncx_selectType'][value='@ATTR']").prop("checked",!0),jQuery("#newcrawler-selector").find("select[name='ncx_attr'] option").each(function(){var a=
this.value;if(null!=a&&""!=a){var b=E(a);if(null!=b&&""!=b&&b.toLowerCase().startsWith("http")&&(jQuery("#newcrawler-selector").find("select[name='ncx_attr']").val(a),"src"==a))return!1}}),jQuery("#newcrawler-selector").find("select[name='ncx_attr']").change();else{if("a"==e.tagName.toLowerCase()&&"Link"==c||z)jQuery("#newcrawler-selector").find("input[name='ncx_selectType'][value='@ATTR']").prop("checked",!0),jQuery("#newcrawler-selector").find("select[name='ncx_attr'] option").each(function(){var a=
this.value;if(null!=a&&""!=a){var b=E(a);if(null!=b&&""!=b&&b.toLowerCase().startsWith("http")&&(jQuery("#newcrawler-selector").find("select[name='ncx_attr']").val(a),"href"==a))return!1}}),jQuery("#newcrawler-selector").find("select[name='ncx_attr']").change()}else"Headline"==c||"Author"==c?(jQuery("#newcrawler-selector").find(".ncx_et_content_inner input[name='ncx_selectType'][value='innerTEXT']").prop("checked",!0),jQuery("#newcrawler-selector").find(".ncx_et_content_inner input[name='ncx_selectType'][value='innerTEXT']").click()):
(jQuery("#newcrawler-selector").find(".ncx_et_content_inner input[name='ncx_selectType'][value='innerHTML']").prop("checked",!0),jQuery("#newcrawler-selector").find(".ncx_et_content_inner input[name='ncx_selectType'][value='innerHTML']").click())}f=0;h=[];c=k=0;for(e=B.length;c<e;c++)if(h[c]=B[c],-1!=h[c].indexOf(":nth-of-type(*)")){for(g=c+1;g<e;g++)h[g]=C[g];var g=h.join(""),g=g.replace(":nth-of-type(*)",""),g=jQuery("#newcrawler").contents().find(g),m=g.length,f=f+m,p=fa(k);k++;for(var t=0;t<m;t++){var y=
g[t];F(b,y)?w(y,!1,c,null):w(y,d,c,p)}h[c]=C[c]}0==f&&f++;z||jQuery("#ncx_toolbar .ncx-datatypes .active .ncx-count").text(f);jQuery("#newcrawler").contents().find(".ncx-accept-highlight").unbind("click").click(function(){for(var d=jQuery(this).attr("lang"),c=0,e=B.length;c<e;c++)-1!=B[c].indexOf(":nth-of-type(*)")&&d!=c&&(B[c]=C[c]);A(b,a,!0)});jQuery("#newcrawler").contents().find(".ncx-reject-highlight").unbind("click").click(function(){for(var d=jQuery(this).attr("lang"),c=0,e=B.length;c<e;c++)-1!=
B[c].indexOf(":nth-of-type(*)")&&d==c&&(B[c]=C[c]);A(b,a,!1)})}function G(b){if(null==b||""==b)return"";b=b.replaceAll("<ncx-text>","").replaceAll("</ncx-text>","");var a=jQuery("#ncx_toolbar .ncx-datatypes .ncx-data-dot.active").attr("title");if("Headline"==a||"Author"==a)b=b.replace(/(?:\r\n|\r|\n)/g,""),b=b.replace(/\s+/g," "),b=b.trim();return b}var I=0,J=[],K={},B=[],C=[];function ka(b){J.push(b);b=jQuery(b).parent();var a=b.get(0);return q(a)?J:ka(b)}
function ia(b){K=b;jQuery("#newcrawler-selector").find("#ncx_edit_tpl_tool").remove();var a=L("et_wrap");r(jQuery("#newcrawler-selector"),a);M("ncx_et_state_10");la();J=[];ka(b);jQuery("#newcrawler-selector").find("#ncx_edit_tpl_tool").removeData("child");jQuery("#newcrawler-selector").find("#ncx_edit_tpl_tool").data("child",J);setTimeout(function(){ma(b)},1)}
function ja(b){K=b;ma(b);jQuery(K).get(0);jQuery("#newcrawler-selector").find(".ncx_et_content_inner input[name='ncx_selectType'][value='innerHTML']").prop("checked",!0);jQuery("#newcrawler-selector").find(".ncx_et_content_inner input[name='ncx_selectType'][value='innerHTML']").click();jQuery("#newcrawler-selector").find("#ncx_copy_xpath_tips").text("");jQuery("#newcrawler-selector").find("#ncx_copy_xpath_text").css({"background-color":"white"});jQuery("#newcrawler-selector").find("#ncx_copy_csspath_tips").text("");
jQuery("#newcrawler-selector").find("#ncx_copy_csspath_text").css({"background-color":"white"})}
function ma(b){jQuery(b).offset();jQuery("#newcrawler").outerHeight();var a=jQuery("#newcrawler").offset().top,d=jQuery("#newcrawler").contents().scrollTop(),e=jQuery(b).offset().top,e=e-d+a,a=jQuery(b).offset().left,d=jQuery(b).outerWidth(),c=jQuery(b).outerHeight(),f=jQuery("#newcrawler").outerHeight();b=jQuery("#newcrawler").outerWidth();var g=jQuery("#newcrawler-selector").find("#ncx_edit_tpl_tool").outerHeight();f-e-c<g?(f=a+d-400,f=a-3,e=e-g-2,0>=f&&(f=0),f+400>b&&(f=a+d-400+3,f>b&&(f=b-400-
10)),jQuery("#newcrawler-selector").find("#ncx_edit_tpl_tool").css({left:f+"px",top:e+"px"})):(f=a+d-400,f=a-3,e=e+c+3,0>=f&&(f=0),f+400>b&&(f=a+d-400+3,f>b&&(f=b-400-10)),jQuery("#newcrawler-selector").find("#ncx_edit_tpl_tool").css({left:f+"px",top:e+"px"}));jQuery("#newcrawler-selector").find("#ncx_edit_tpl_tool").css({opacity:"1"});var h=jQuery("#newcrawler-selector").find("#ncx_edit_tpl_tool"),k=h.offset().top,m=jQuery(jQuery("#newcrawler").contents()).scrollTop();jQuery(jQuery("#newcrawler").contents()).on("scroll",
function(){var a=jQuery(this).scrollTop()-m,a=k-a;h.stop(!1,!1).animate({top:47>a?47:a},0)})}
function L(b){var a="";switch(b){case "et_wrap":a="<div class='ncx_edit_tpl_tool' style='opacity: 0;position : absolute; z-index : 999990;' id='ncx_edit_tpl_tool'><ul id='ncx_et_bar' class='ncx_et_bar'><li class='ncx_col1'><div id='ncx_larger' class='ncx_larger'></div><div id='ncx_smaller' class='ncx_smaller'></div></li><li class='ncx_col4' id='ncx_et_state_4'><span class='ncx_bar_button_tilte'>Preview</span></li>";a+="</ul><div id='ncx_et_content' class='ncx_et_content'></div></div>";break;case "et_conetent_inner_20":a=
"<div class='ncx_et_content_inner' id='ncx_copy_xpath_container' style='position:relative'><pre id='ncx_copy_xpath_text' class='ncx_xpath'>xpath express test!!!</pre>";a+="<div class='ncx_button'><button id='ncx_copy_xpath_button' class='ncx_xpath_copy'>Copy Selector</button><button class='ncx_et_cancel'></button></div>";a+="<div id='ncx_copy_xpath_tips' class='ncx_tips'></div>";a+="</div>";break;case "et_conetent_inner_30":a="<div class='ncx_et_content_inner' id='ncx_copy_csspath_container' style='position:relative'><pre id='ncx_copy_csspath_text' class='ncx_csspath'>csspath express test!!!</pre>";
a+="<div class='ncx_button'><button id='ncx_copy_csspath_button' class='ncx_csspath_copy'>Copy Selector</button><button class='ncx_et_cancel'></button></div>";a+="<div id='ncx_copy_csspath_tips' class='ncx_tips'></div>";a+="</div>";break;case "et_conetent_inner_40":a="<div class='ncx_et_content_inner'><div><input name='ncx_property_name' type='text' value='' placeholder='Property Name' style='vertical-align: middle;height: 25px;'></div>",a+="<div><pre id='ncx_copy_xpath_text' class='ncx_xpath ncx_expression'>xpath express test!!!</pre></div>",
a+="<div style='height: 22px;'>",a+="<div style='float:left;margin-left:0px;width:80px;'><input name='ncx_selectType' type='radio' value='outerHTML' style='vertical-align: middle;'><span>outerHTML</span></div>",a+="<div style='float:left;margin-left:0px;width:80px;'><input name='ncx_selectType' type='radio' value='innerHTML' style='vertical-align: middle;' checked='checked' ><span>innerHTML</span></div>",a+="<div style='float:left;margin-left:0px;width:80px;'><input name='ncx_selectType' type='radio' value='innerTEXT' style='vertical-align: middle;'><span>innerTEXT</span></div>",
a+="<div style='float:left;margin-left:0px;width:80px;'><input name='ncx_selectType' type='radio' value='@ATTR' style='vertical-align: middle;display:none;'><span><select name='ncx_attr' style='width: 130px;'></select></span></div>",a+="</div>",a+="<div><pre id='ncx_content_preview' class='ncx_content'></pre></div>",a+="<div class='ncx_button'>",a+="<button id='ncx_copy_xpath_button' class='ncx_xpath_copy'>Copy Selector</button>",a+="<button class='ncx_et_cancel'></button>",a+="<button class='ncx_et_create'></button>",
a+="</div>",a+="<div class='ncx_tips'></div></div>"}return a}
function N(){var b=new ZeroClipboard(document.getElementById("ncx_copy_csspath_button"));b.on("ready",function(){b.on("copy",function(a){a.clipboardData.setData("text/plain",jQuery("#newcrawler-selector").find("#ncx_copy_csspath_text").text())});b.on("aftercopy",function(){jQuery("#newcrawler-selector").find(".ncx_et_content_inner .ncx_tips").text("Copied CssPath.");jQuery("#newcrawler-selector").find(".ncx_et_content_inner .ncx_expression").css({"background-color":"white"});jQuery("#newcrawler-selector").find("#ncx_copy_csspath_text").css({"background-color":"rgb(236, 248, 233)"})})});
var a=new ZeroClipboard(document.getElementById("ncx_copy_xpath_button"));a.on("ready",function(){a.on("copy",function(a){a.clipboardData.setData("text/plain",jQuery("#newcrawler-selector").find("#ncx_copy_xpath_text").text())});a.on("aftercopy",function(){jQuery("#newcrawler-selector").find(".ncx_et_content_inner .ncx_tips").text("Copied XPath.");jQuery("#newcrawler-selector").find(".ncx_et_content_inner .ncx_expression").css({"background-color":"white"});jQuery("#newcrawler-selector").find("#ncx_copy_xpath_text").css({"background-color":"rgb(236, 248, 233)"})})})}
function E(b){b||(b=jQuery("#newcrawler-selector").find(".ncx_et_content_inner select[name='ncx_attr']").val());var a=C.join(""),a=a.replace(":nth-of-type(*)",""),a=jQuery("#newcrawler").contents().find(a),d="";0<a.length&&(d=a.prop(b));return d}
function M(b){jQuery("#newcrawler-selector").find("#ncx_et_bar").removeClass("ncx_shape1");jQuery("#newcrawler-selector").find(".ncx_bar_button_tilte").removeClass("ncx_on");jQuery("#newcrawler-selector").find("#ncx_et_content").removeClass("ncx_shape1");jQuery("#newcrawler-selector").find("#ncx_et_content").empty();switch(b){case "ncx_et_state_10":jQuery("#newcrawler-selector").find("#ncx_et_bar").addClass("ncx_shape1");break;case "ncx_et_state_20":jQuery("#newcrawler-selector").find("#ncx_et_bar").addClass("ncx_shape1");
jQuery("#newcrawler-selector").find(".ncx_col2 > .ncx_bar_button_tilte").addClass("ncx_on");jQuery("#newcrawler-selector").find("#ncx_et_content").addClass("ncx_shape1");b=L("et_conetent_inner_20");r(jQuery("#newcrawler-selector").find("#ncx_et_content"),b);b=O(jQuery(K).get(0));jQuery("#newcrawler-selector").find("#ncx_copy_xpath_text").text(b);N();break;case "ncx_et_state_30":jQuery("#newcrawler-selector").find("#ncx_et_bar").addClass("ncx_shape1");jQuery("#newcrawler-selector").find(".ncx_col3 > .ncx_bar_button_tilte").addClass("ncx_on");
jQuery("#newcrawler-selector").find("#ncx_et_content").addClass("ncx_shape1");b=L("et_conetent_inner_30");r(jQuery("#newcrawler-selector").find("#ncx_et_content"),b);b=O(jQuery(K).get(0));jQuery("#newcrawler-selector").find("#ncx_copy_csspath_text").text(b);N();break;case "ncx_et_state_40":jQuery("#newcrawler-selector").find("#ncx_et_bar").addClass("ncx_shape1"),jQuery("#newcrawler-selector").find(".ncx_col4 > .ncx_bar_button_tilte").addClass("ncx_on"),jQuery("#newcrawler-selector").find("#ncx_et_content").addClass("ncx_shape1"),
b=L("et_conetent_inner_40"),r(jQuery("#newcrawler-selector").find("#ncx_et_content"),b),jQuery(K).get(0),jQuery("#newcrawler-selector").find(".ncx_et_content_inner select[name='ncx_attr']").unbind("change").change(function(){jQuery("#newcrawler-selector").find(".ncx_et_content_inner input[name=ncx_selectType][value='@ATTR']").prop("checked",!0);if(""==this.value)jQuery("#newcrawler-selector").find(".ncx_et_content_inner input[name=ncx_selectType][value='innerHTML']").prop("checked",!0),jQuery("#newcrawler-selector").find(".ncx_et_content_inner input[name=ncx_selectType][value='innerHTML']").click();
else{var a=E();jQuery("#newcrawler-selector").find("#ncx_content_preview").text(G(a))}}),jQuery("#newcrawler-selector").find(".ncx_et_content_inner input[name=ncx_selectType]").unbind("click").click(function(){jQuery("#newcrawler-selector").find(".ncx_et_content_inner select[name='ncx_attr']").val("");switch(jQuery(this).val()){case "outerHTML":var a=jQuery(K).get(0),a=a.outerHTML;jQuery("#newcrawler-selector").find("#ncx_content_preview").text(G(a));break;case "innerHTML":a=jQuery(K).get(0);a=a.innerHTML;
jQuery("#newcrawler-selector").find("#ncx_content_preview").text(G(a));break;case "innerTEXT":jQuery("#newcrawler-selector").find("#ncx_content_preview").text(G(jQuery(K).text()))}}),N()}jQuery("#newcrawler-selector").find(".ncx_et_cancel").unbind("click").click(function(){x()});jQuery("#newcrawler-selector").find(".ncx_et_create").unbind("click").click(function(){var a=B.join(""),b=jQuery("#ncx_toolbar .ncx-datatypes .ncx-data-dot.active").attr("lang"),e=jQuery("#newcrawler-selector").find("input[name=ncx_selectType]:checked").val(),
c=jQuery("#newcrawler-selector").find("select[name='ncx_attr']").val(),f=jQuery("#newcrawler-selector").find("input[name=ncx_property_name]").val();if(null==f||""==f)if(f="property",z)b=0,f="pagination";else for(var g=b;500>g;g++){for(var f="property"+g,h=!1,k=1,m=D.length;k<m;k++)if(f==D[k].name){h=!0;break}if(!h)break}P(null,b,f,a,B,e,z,c);x()})}function na(b){var a=[];b=b.split(" > ");for(var d=0,e=b.length;d<e;d++)""!=b[d]&&(a.push(" > "),a.push(b[d]));" > "==a[0]&&(a=a.slice(1));return a}
function P(b,a,d,e,c,f,g,h){if(g)D[0]={id:b,index:0,name:d,c:e,a:c,g:f,f:h};else{g=e.replace(":nth-of-type(*)","");g=jQuery("#newcrawler").contents().find(g).length;if(jQuery("#ncx_toolbar .ncx-datatypes .ncx-data-dot.active").hasClass("finished")){b=jQuery("#ncx_toolbar .ncx-datatypes .ncx-data-dot.active").attr("lang");for(var k=1,m=D.length;k<m;k++)if(a=D[k].index,b==a){D[k].c=e;D[k].a=c;D[k].g=f;D[k].f=h;break}jQuery("#ncx_toolbar .ncx-datatypes .ncx-data-dot.active .ncx-count").attr("lang",g);
jQuery("#ncx_toolbar .ncx-datatypes .ncx-data-dot.active .ncx-count").text(g)}else jQuery('<a lang="'+Q+'" class="ncx-label ncx-data-dot ncx-blue finished" title="'+d+'"><span class="ncx-count" lang="'+g+'">'+g+'</span><span class="ncx-delete-datatype" style="display: none;"></span></a>').insertBefore(jQuery("#ncx_toolbar .ncx-datatypes .ncx-label.ncx-yellow.active")),D.push({id:b,index:a,name:d,c:e,a:c,g:f,f:h}),Q+=1,jQuery("#ncx_toolbar .ncx-datatypes .ncx-data-dot.ncx-yellow.active").attr("lang",
Q);jQuery("#ncx_toolview .ncx-export-window-wordpress .ncx-export-content select.allFileds").append("<option value='${"+d+"}'>"+d+"</option>");a=jQuery("#ncx_toolview .ncx-export-window-db .ncx-export-content .fieldMap .temp").clone();a.removeClass("temp");a.find(".labelName").text(d);a.find("input[name=labelName]").val("${"+d+"}");a.find("input[name=param]").val(d);jQuery("#ncx_toolview .ncx-export-window-db .ncx-export-content .fieldMap").append(a);jQuery("#ncx_toolview .ncx-export-window-rss .ncx-export-content select.allFileds").append("<option value='"+
d+"'>"+d+"</option>")}jQuery("#ncx_toolbar .save").attr("disabled",!1);oa()}function F(b,a){return void 0==b||void 0==a?!1:0==b.compareDocumentPosition(a)?!0:!1}
function O(b){B=[];for(C=[];b&&void 0!==b.tagName;b=b.parentNode){var a=b.tagName;if(!a)break;a=a.toLowerCase();if("ncx_cover-container"!=b.id){var d=jQuery(b).parent().children(a).not("#ncx_cover-container"),e=d.length,c="",f="";if(1<e)for(var g=0;g<e;g++){var h=d[g];if(F(b,h))""==c&&(c=":nth-of-type("+(g+1)+")"),f=":nth-of-type("+(g+1)+")";else if(":nth-of-type(*)"!=c)if(0<B.length){var k=C.join(""),h=jQuery(h).find(k).length;0<h&&0<h&&(c=":nth-of-type(*)")}else c=":nth-of-type(*)"}""==c&&(f=c=
"");if("html"==a||"body"==a)f=c="";c=a+c;f=a+f;d=pa(a);if(g=b.className)for(var k=g.split(" "),m=0,p=null,g=null,h=0,e=k.length;h<e;h++)if(""!=k[h]&&!/\d/.test(k[h])){var p=null==p?k[h]:p+("."+k[h]),t=pa(a+"."+p);0==m?(m=t,g=p):0<t&&t<m&&(g=p,m=t)}e=!1;h="#";k="";g&&!/\s/.test(g)?(e=!0,h=".",k=g):b.id&&!/\s/.test(b.id)&&(e=!0,k=b.id,isNaN(k)||(k="\\3"+b.id));if(e){if(z)for(e=!1,g=0,m=B.length;g<m;g++)if("a"==B[g]||0==B[g].indexOf("a[")){e=!0;break}if(e&&(a=a+h+k,e=pa(a),(e==d||1==e)&&qa(a,0)))if(!z&&
1<D.length){if(a==D[1].a[0]){B.unshift(a);C.unshift(a);break}}else{B.unshift(a);C.unshift(a);break}}B.unshift(c);B.unshift(" > ");C.unshift(f);C.unshift(" > ")}}" > "==B[0]&&(B=B.slice(1),C=C.slice(1));b=B.join("");if(1<D.length)for(h=0,b=B.length;h<b;h++){c=!0;if(h>D[1].a.length||D[1].a[h]!=B[h])c=!1;c||-1==B[h].indexOf(":nth-of-type(*)")||(B[h]=C[h])}return b=B.join("")}
function qa(b,a){for(var d=a,e=!1,c=B.slice(0),f=0,g=c.length;f<g;f++)-1!=c[f].indexOf(":nth-of-type(*)")&&(f>a||0==a?d==a?(c[f]=c[f].replace(":nth-of-type(*)",""),a=f):(e=!0,c[f]=C[f]):c[f]=C[f]);c.unshift(b);b=c.join("");var h=!0,k=null;jQuery("#newcrawler").contents().find(b).each(function(){if(null==k)k=ra(this,c);else{var a=ra(this,c);if(!F(a[0],k[0]))return h=!1}});return e?h&&qa(b,a):h}function ra(b,a){for(var d=a.length/2-1,e=jQuery(b).parent(),c=0;c<d;c++)e=jQuery(e).parent();return e}
function pa(b){for(var a=B.slice(0),d=0,e=a.length;d<e;d++)-1!=a[d].indexOf(":nth-of-type(*)")&&(a[d]=C[d]);a.unshift(b);b=a.join("");return jQuery("#newcrawler").contents().find(b).length}
function la(){jQuery("#newcrawler-selector").find("#ncx_larger").mouseover(function(){jQuery(this).addClass("ncx_on")});jQuery("#newcrawler-selector").find("#ncx_smaller").mouseover(function(){jQuery(this).addClass("ncx_on")});jQuery("#newcrawler-selector").find("#ncx_larger").mouseout(function(){jQuery(this).removeClass("ncx_on")});jQuery("#newcrawler-selector").find("#ncx_smaller").mouseout(function(){jQuery(this).removeClass("ncx_on")});jQuery("#newcrawler-selector").find(".ncx_bar_button_tilte").mouseover(function(){jQuery(this).addClass("ncx_onhover")});
jQuery("#newcrawler-selector").find(".ncx_bar_button_tilte").mouseout(function(){jQuery(this).removeClass("ncx_onhover")});jQuery("#newcrawler-selector").find("#ncx_larger").unbind("click").click(function(){var b=jQuery("#newcrawler-selector").find("#ncx_edit_tpl_tool").data("child");I<b.length&&I++;b=b[I];q(b)||(O(jQuery(b).get(0)),A(jQuery(b).get(0),2,!1))});jQuery("#newcrawler-selector").find("#ncx_smaller").unbind("click").click(function(){var b=jQuery("#newcrawler-selector").find("#ncx_edit_tpl_tool").data("child");
0<I&&I--;b=b[I];q(b)||(O(jQuery(b).get(0)),A(jQuery(b).get(0),2,!1))});jQuery("#newcrawler-selector").find("#ncx_et_state_2").unbind("click").click(function(){M("ncx_et_state_20")});jQuery("#newcrawler-selector").find("#ncx_et_state_3").unbind("click").click(function(){M("ncx_et_state_30")});jQuery("#newcrawler-selector").find("#ncx_et_state_4").unbind("click").click(function(){M("ncx_et_state_40")});jQuery("#newcrawler-selector").find("#ncx_et_state_4").trigger("click");jQuery("#newcrawler-selector").find("#ncx_edit_tpl_tool").i()}
String.prototype.replaceAll=function(b,a){return this.replace(new RegExp(b,"gm"),a)};var Q=1,z=!1,D=[],R=null,S=null,T=null,U=0,sa=0,V=null,W=null;
function Y(b,a,d,e){var c=document.getElementById("ncx_message-box");c?(c.innerHTML="",c.style.display="none"):(c=document.createElement("div"),c.innerHTML='<div id="ncx_message-box" style="border-radius: 2px;padding: 5px 15px; font-size: 12px; font-color: #333; font-weight: bold; position: fixed!important; top: 50px; left: 50%; z-index: 2147483500; display: none;"></div>',document.body.appendChild(c.firstChild),c=document.getElementById("ncx_message-box"));"hide"==b?(c.innerHTML="",c.style.display=
"none"):("show"==b?(c.innerHTML=a,c.style.display="block",c.style.marginLeft=-(c.clientWidth/2)+"px"):"fade"==b&&(c.innerHTML=a,c.style.display="block",c.style.marginLeft=-(c.clientWidth/2)+"px",setTimeout(function(){Y("hide")},d)),jQuery(document).find("#ncx_message-box").removeClass("message_red"),jQuery(document).find("#ncx_message-box").removeClass("message_green"),jQuery(document).find("#ncx_message-box").removeClass("message_yellow"),"red"==e?jQuery(document).find("#ncx_message-box").addClass("message_red"):
"green"==e?jQuery(document).find("#ncx_message-box").addClass("message_green"):jQuery(document).find("#ncx_message-box").addClass("message_yellow"))}
function ua(){jQuery("#newcrawler").contents().find("body").append('<div id="ncx_cover-container"><div id="ncx_curlCover" class="ncx_curlCover"  style="z-index : 1999999999; filter:Alpha(Opacity=100); -moz-opacity: 1; opacity: 1;  pointer-events:none; text-align: left; background : transparent;top:0;left:0;position:absolute;overflow:hidden;"></div></div>');jQuery("#newcrawler").contents().find("body").css({cursor:"pointer"});document.title="New Crawler\u2122 "+jQuery("#newcrawler").contents().find("title").text();
R=va("webCrawlerId");S=va("siteId");T=va("rulesVerId");var b=jQuery("#newcrawler").contents().height(),a=jQuery("#newcrawler").contents().width();600>a&&(a=980);jQuery("#newcrawler").contents().find("#ncx_curlCover").css({width:a,height:b+8})}
function wa(){jQuery("#newcrawler").contents().find("*").unbind();jQuery("#newcrawler").contents().find("a").unbind("click").click(function(){return!1});jQuery("#newcrawler").contents().find("body").contents().find("*").each(function(){jQuery(this).off()});jQuery("#newcrawler").contents().find("body").contents().find("*").each(function(){this.onclick=function(){return!1};this.onmouseleave=function(){return!1};this.onmousedown=function(){return!1};this.onmouseover=function(){return!1}});jQuery("#newcrawler").contents().find("body").contents().find("*").not("iframe").contents().filter(function(){var b=
3==this.nodeType,a=!1;1<jQuery(this).parent().contents().length&&(a=!0);return b&&a}).wrap("<ncx-text></ncx-text>");jQuery("#newcrawler").contents().find("body").contents().find("*").bind("mouseover",function(b){b=b||window.event;b=b.target||b.srcElement;if("html"!=jQuery(b).get(0).tagName.toLowerCase()&&"ncx_highlightTool"!=jQuery(b).attr("class")&&1==l){aa=1;ba=b;jQuery("#newcrawler").contents().find("#ncx_curlCover .ncx_highlightTool").remove();jQuery("#newcrawler").contents().find("#ncx_curlCover").append("<div id='ncx_traceHighlight_top' class='ncx_highlightTool'></div>");
jQuery("#newcrawler").contents().find("#ncx_curlCover").append("<div id='ncx_traceHighlight_right' class='ncx_highlightTool'></div>");jQuery("#newcrawler").contents().find("#ncx_curlCover").append("<div id='ncx_traceHighlight_bottom' class='ncx_highlightTool'></div>");jQuery("#newcrawler").contents().find("#ncx_curlCover").append("<div id='ncx_traceHighlight_left' class='ncx_highlightTool'></div>");var a=jQuery("#newcrawler").contents().find("#ncx_traceHighlight_top"),d=jQuery("#newcrawler").contents().find("#ncx_traceHighlight_right"),
e=jQuery("#newcrawler").contents().find("#ncx_traceHighlight_bottom"),c=jQuery("#newcrawler").contents().find("#ncx_traceHighlight_left"),f=jQuery(b).offset(),g=jQuery(b).outerWidth(),h=jQuery("#newcrawler").contents().width();g>h&&(g=h-8);u(a,f.left-2,f.top-2,g+4,2,"border-bottom");u(d,f.left+g,f.top,2,jQuery(b).outerHeight(),"border-left");u(e,f.left-2,f.top+jQuery(b).outerHeight(),g+4,2,"border-top");u(c,f.left-2,f.top,2,jQuery(b).outerHeight(),"border-right")}return!1});jQuery("#newcrawler").contents().find("body").contents().find("*").each(function(){jQuery(this).unbind("click").click(function(){I=
0;if(1==aa){var b=ba;jQuery("#ncx_toolbar .ncx-datatypes .active").hasClass("ncx-cron")&&(jQuery("#ncx_toolbar .ncx-datatypes .ncx-cron").removeClass("active"),jQuery("#ncx_toolbar .ncx-cron-config").hide(),jQuery("#ncx_toolbar .ncx-datatypes .ncx-data-dot.ncx-yellow").addClass("active"));jQuery("#ncx_toolbar .ncx-datatypes .active").hasClass("ncx-setting")&&(jQuery("#ncx_toolbar .ncx-datatypes .ncx-setting").removeClass("active"),jQuery("#ncx_toolbar .ncx-setting-config").hide(),jQuery("#ncx_toolbar .ncx-datatypes .ncx-data-dot.ncx-yellow").addClass("active"));
jQuery("#ncx_toolbar .ncx-datatypes .active").hasClass("ncx-pagination")?z=!0:(jQuery("#ncx_toolbar .ncx-setting-config").hide(),jQuery("#ncx_toolbar .ncx-cron-config").hide(),jQuery("#ncx_toolbar .ncx-datatypes .ncx-cron").removeClass("active"),jQuery("#ncx_toolbar .ncx-datatypes .ncx-setting").removeClass("active"),z=!1);O(b);jQuery("#newcrawler").contents().find("#ncx_curlCover").css({"pointer-events":"auto"});var a=!1;1<D.length&&(a=!0);A(b,1,a)}return!1})})}
function xa(){var b=decodeURIComponent(newcrawler_fetch_url);jQuery("#ncx_toolbar #url").text(b);jQuery("#ncx_toolbar #url").parent().attr("href",b).attr("title",b);jQuery("#ncx_toolbar .ncx-save").unbind("click").click(function(){ya(function(){jQuery("#ncx_toolbar .ncx-cron-config").hide();jQuery("#ncx_toolbar .ncx-setting-config").hide()})});jQuery("#ncx_toolbar .ncx-test").click(function(){jQuery("#ncx_toolview").hide(100);jQuery("#ncx_tooltest .ncx-content-top-details").hide(100);jQuery("#ncx_toolbar .ncx-test .view-pop").toggle(600);
jQuery("#ncx_tooltest").toggle(600,function(){if(jQuery("#ncx_tooltest").is(":visible")){var a=jQuery("#ncx_toolbar #url").parent().attr("href");za(a);jQuery(window).trigger("resize")}})});jQuery("#ncx_tooltest .ncx-details").click(function(){jQuery("#ncx_tooltest .ncx-content-top-details").toggle(100)});jQuery("#ncx_tooltest .ncx-next").click(function(){var a=jQuery("#ncx_tooltest .ncx-details-content .nextUrl").attr("href");null!=a&&""!=a&&za(a)});jQuery("#ncx_toolbar .ncx-view").click(function(){jQuery("#ncx_tooltest").hide(100);
null==R||void 0==R||isNaN(R)||(Aa.v.webCrawlerId=R,Ba());jQuery("#ncx_toolview .ncx-content-top-export").hide(100);jQuery("#ncx_toolbar .ncx-view .view-pop").toggle(600);jQuery("#ncx_toolview").toggle(600,function(){jQuery("#ncx_toolview").is(":visible")?(document.body.parentNode.style.overflow="hidden",jQuery("#ncx_toolview #ncx-crawlDataLog").show(),W.init(function(){jQuery(window).trigger("resize")}),20==jQuery("#ncx_toolview > .ncx-content-top").find("#ncx-pagination-size").val()&&Ca(),jQuery(window).trigger("resize")):
(document.body.parentNode.style.overflow="auto",jQuery("#ncx_toolview #ncx-crawlDataLog").hide(),W.destory())})});jQuery(window).resize(function(){var a=window,b=document,e=b.documentElement,c=b.getElementsByTagName("body")[0],b=(a.innerHeight||e.clientHeight||c.clientHeight)-46,a=(a.innerWidth||e.clientWidth||c.clientWidth)-50;jQuery("#ncx_toolview").outerWidth(a);jQuery("#ncx_toolview").outerHeight(b);jQuery("#ncx_tooltest").outerWidth(a);jQuery("#ncx_tooltest").outerHeight(b);jQuery(".ncx-content-bottom").outerHeight(b-
jQuery(".ncx-content-top").outerHeight(!0));jQuery(".logsViewConsoleWindow").outerHeight(jQuery(".ncx-content-bottom").outerHeight(!0)-jQuery("#ncx_toolview #ncx-crawlDataLog").outerHeight(!0))});jQuery("#ncx_toolbar .ncx-js .isJavaScript").click(function(){ya(function(){top.window.location.href=V})});jQuery("#ncx_toolview .ncx-refresh").click(function(){Ca()});jQuery("#ncx_toolview .ncx-export").click(function(){jQuery("#ncx_toolview .ncx-export-window").is(":visible")?jQuery("#ncx_toolview .ncx-export-window").hide(100):
jQuery("#ncx_toolview .ncx-content-top-export").toggle(100)});jQuery("#ncx_toolview .ncx-export-plotly").click(function(){var a,b={};a=[];for(var e=document.getElementById("ncx_data_list"),c=e.rows[0],f=c.cells.length,g=0;g<f;g+=1){var h=c.cells[g];a.push(h.innerHTML)}c=e.rows.length;for(f=1;f<c;f+=1)for(var g=e.rows[f],k=g.cells.length,m=0;m<k;m+=1){var h=g.cells[m],p=a[m],h=h.innerHTML;if(null==b[p]||void 0==b[p])b[p]={data:[]};b[p].data.push(h)}a={cols:b};b=jQuery('<div id="hiddenform" style="display:none;"><form action="https://plot.ly/datagrid" method="post" target="_blank" accept-charset="utf-8"><input type="text" name="data" /></form></div>').appendTo("body");
a=JSON.stringify(a);b.find("input").val(a);b.find("form").submit();b.remove()});jQuery("#ncx_toolview .ncx-export-coding").click(function(){if(null!=S&&""!=S){var a=newcrawler_app_url+"api/data/export?siteId="+S+"&pageNum="+(U+1)+"&type=json";jQuery("#ncx_toolview .ncx-export-coding").attr("href",a)}});jQuery("#ncx_toolview .ncx-export-window .close").click(function(){jQuery("#ncx_toolview .ncx-content-top").show();jQuery("#ncx_toolview .ncx-content-bottom").show();jQuery("#ncx_toolview .ncx-export-window").hide(400)});
jQuery("#ncx_toolview .ncx-export-rss.ncx-export-icon").click(function(){jQuery("#ncx_toolview .ncx-content-top-export").hide();jQuery("#ncx_toolview .ncx-content-top").hide();jQuery("#ncx_toolview .ncx-content-bottom").hide();jQuery("#ncx_toolview .ncx-export-window-rss").toggle(600,function(){if(jQuery("#ncx_toolview .ncx-export-window-rss").is(":visible")&&(jQuery("#ncx_toolview .ncx-export-window-rss .title").text(),null!=S&&""!=S)){Z.crawlDataExportService.query(function(a,b){if(b){var c="System errors.";
b.b&&(c=b.b);Y("fade",c,3E3,"red")}else a&&(c=eval(a),Da(c))},R,S,"rss");var a=newcrawler_app_url+"api/data/export?siteId="+S+"&pageNum="+(U+1)+"&type=rss";jQuery("#ncx_toolview .ncx-export-window-rss .ncx-btn-rss").attr("href",a)}})});jQuery("#ncx_toolview .ncx-export-wordpress.ncx-export-icon").click(function(){jQuery("#ncx_toolview .ncx-content-top-export").hide();jQuery("#ncx_toolview .ncx-content-top").hide();jQuery("#ncx_toolview .ncx-content-bottom").hide();jQuery("#ncx_toolview .ncx-export-window-wordpress").toggle(600,
function(){if(jQuery("#ncx_toolview .ncx-export-window-wordpress").is(":visible")){var a=jQuery("#ncx_toolview .ncx-export-window-wordpress .title").text();null!=S&&""!=S&&Z.dataDeployService.queryByXpath(function(a,b){if(b){var c="System errors.";b.b&&(c=b.b);Y("fade",c,3E3,"red")}else a&&(c=eval("("+a+")"),Ea(c))},R,S,a)}})});jQuery("#ncx_toolview .ncx-export-db.ncx-export-icon").click(function(){jQuery("#ncx_toolview .ncx-content-top-export").hide();jQuery("#ncx_toolview .ncx-content-top").hide();
jQuery("#ncx_toolview .ncx-content-bottom").hide();jQuery("#ncx_toolview .ncx-export-window-db").toggle(600,function(){if(jQuery("#ncx_toolview .ncx-export-window-db").is(":visible")){var a=jQuery("#ncx_toolview .ncx-export-window-db .title").text();null!=S&&""!=S&&Z.dataDeployService.queryByXpath(function(a,b){if(b){var c="System errors.";b.b&&(c=b.b);Y("fade",c,3E3,"red")}else a&&(c=eval("("+a+")"),Fa(c))},R,S,a)}})});jQuery("#ncx_toolview .ncx-run").click(function(){var a=jQuery("#ncx_toolbar #ncx-cron-id").val();
Z.scheduleService.execute(function(a,b){if(b){var c="System errors.";b.b&&(c=b.b);Y("fade",c,3E3,"red")}else a&&(Y("fade","Task running...",3E3),setTimeout(function(){W.init(function(){jQuery(window).trigger("resize")})},2E3))},R,S,a)});jQuery("#ncx_toolview .ncx-export-csv").click(function(){jQuery("#ncx_data_list").table2excel({name:"NewCrawler Data",m:"xls",filename:"NewCrawlerData"})});jQuery("#ncx_toolbar #ncx-charset-select").change(function(){var a=jQuery("#ncx_toolbar #ncx-charset-select").val();
null==a||""==a?(jQuery("#ncx_toolbar #ncx-charset").show(),jQuery("#ncx_toolbar #ncx-charset").val("")):(jQuery("#ncx_toolbar #ncx-charset").hide(),jQuery("#ncx_toolbar #ncx-charset").val(a))});oa()}
function oa(){jQuery("#ncx_toolbar .ncx-datatypes .ncx-data-dot .ncx-delete-datatype").unbind("click").click(function(){var b=jQuery(this).parent().attr("title"),a=jQuery(this).parent().attr("lang"),d=[];d.push(D[0]);for(var e=1,c=D.length;e<c;e++)a!=D[e].index&&d.push(D[e]);D=d;jQuery(this).parent().remove();void 0==jQuery("#ncx_toolbar .ncx-datatypes .ncx-label.finished")&&jQuery("#ncx_toolbar .save").attr("disabled",!0);Ga(b);jQuery("#ncx_toolbar .ncx-datatypes .ncx-label.ncx-data-dot.ncx-yellow").addClass("active");
jQuery("#ncx_toolbar .ncx-datatypes .ncx-label.ncx-data-dot.ncx-yellow").click()});jQuery("#ncx_toolbar .ncx-datatypes .ncx-label.finished").unbind("mouseout").mouseout(function(){jQuery(this).find(".ncx-delete-datatype").hide();jQuery(this).find(".ncx-delete-datatype").removeClass("visible")});jQuery("#ncx_toolbar .ncx-datatypes .ncx-data-dot").unbind("click").click(function(){jQuery(this).hasClass("ncx-pagination")||jQuery(this).hasClass("ncx-cron")||jQuery(this).hasClass("ncx-setting")?(jQuery(this).hasClass("active")||
(jQuery("#ncx_toolbar .ncx-data-dot").each(function(){jQuery(this).removeClass("active")}),jQuery(this).addClass("active")),jQuery(this).hasClass("ncx-cron")?jQuery("#ncx_toolbar .ncx-cron-config").is(":visible")?(jQuery("#ncx_toolbar .ncx-cron-config").hide(),jQuery(this).removeClass("active")):jQuery("#ncx_toolbar .ncx-cron-config").show():jQuery("#ncx_toolbar .ncx-cron-config").hide(),jQuery(this).hasClass("ncx-setting")?jQuery("#ncx_toolbar .ncx-setting-config").is(":visible")?(jQuery("#ncx_toolbar .ncx-setting-config").hide(),
jQuery(this).removeClass("active")):jQuery("#ncx_toolbar .ncx-setting-config").show():jQuery("#ncx_toolbar .ncx-setting-config").hide()):(jQuery("#ncx_toolbar .ncx-datatypes .ncx-data-dot").removeClass("active"),jQuery(this).addClass("active"),jQuery("#ncx_toolbar .ncx-cron-config").hide(),jQuery("#ncx_toolbar .ncx-setting-config").hide());var b=jQuery(this).attr("lang");if(null!=b&&""!=b&&void 0!=b)for(var a in D)if(b==D[a].index){var d=D[a].c;D[a].a.slice(0);for(var d=d.replace(":nth-of-type(*)",
""),d=jQuery("#newcrawler").contents().find(d),e=d.length,c=0;c<e;c++){var f=d[c];if(0==c){var g=jQuery(f).offset().top,f=jQuery(f).outerHeight(),h=0;65>jQuery("#newcrawler").contents().outerHeight()-g-f?(h=g+1,0>h&&(h=0)):h=g+f+3;jQuery("#newcrawler").contents().scrollTop(h-300)}}}});jQuery("#ncx_toolbar .ncx-datatypes .ncx-label.finished").unbind("mouseout").mouseout(function(){jQuery(this).find(".ncx-delete-datatype").hide();jQuery(this).find(".ncx-delete-datatype").removeClass("visible")});jQuery("#ncx_toolbar .ncx-datatypes").unbind("mouseout").mouseout(function(){x()});
jQuery("#ncx_toolbar .ncx-datatypes .ncx-data-dot").unbind("mouseover").mouseover(function(){jQuery(this).hasClass("ncx-label")&&jQuery(this).hasClass("finished")&&(jQuery(this).find(".ncx-delete-datatype").show(),jQuery(this).find(".ncx-delete-datatype").addClass("visible"));x();var b=jQuery(this).attr("lang");if(null!=b&&""!=b&&void 0!=b)for(var a in D)if(b==D[a].index){var d=D[a].c;D[a].a.slice(0);for(var d=d.replace(":nth-of-type(*)",""),d=jQuery("#newcrawler").contents().find(d),e=d.length,c=
0;c<e;c++)w(d[c],!1,0,null)}})}function va(b){for(var a=window.location.search.substring(1).split("&"),d=0;d<a.length;d++){var e=a[d].split("=");if(e[0]==b)return e[1]}return""}
function Ha(b){if(null!=R&&void 0!=R&&!isNaN(R)){jQuery("#ncx_toolbar .save").attr("disabled",!0);D[0]={};var a=null;if(null!=S&&""!=S&&null!=T&&""!=T&&(jQuery("#ncx_toolbar #ncx-headers").val(""),jQuery("#ncx_toolbar #ncx-charset-select").val(""),jQuery("#ncx_toolbar #ncx-charset-select").change(),urlString=newcrawler_server_url+"member/rules/query?webCrawlerId="+R+"&siteId="+S+"&rulesVerId="+T,jQuery.ajax({type:"GET",dataType:"json",url:urlString,async:!1,success:function(b){a=b},error:function(a,
b,c){console.log(c);jQuery("#ncx_toolbar .ncx-toolbar-section.msg").html("<div><span style='color:red;'>System errors.</span></div>");setTimeout(function(){jQuery("#ncx_toolbar .ncx-toolbar-section.msg").html("")},3E3)}}),null!=a&&""!=a)){var d=a.cronId,e=a.cronDate,c=a.cronTime,f=a.pluginId,g=a.isJs,h=a.charset,k=a.headers;jQuery("#ncx_toolbar .ncx-js input[type=checkbox][name='ncx-isJs']").prop("checked",g);jQuery("#ncx_toolbar .ncx-js #ncx-pluginId").val(f);jQuery("#ncx_toolbar #ncx-cron-id").val(d);
jQuery("#ncx_toolbar #ncx-cron-date").val(e);jQuery("#ncx_toolbar #ncx-cron-time").val(c);jQuery("#ncx_toolbar #ncx-headers").val(k);jQuery("#ncx_toolbar #ncx-charset-select").val(h);jQuery("#ncx_toolbar #ncx-charset-select").change();var a=a.rules,m;for(m in a)isNaN(m)||"csspath"!=a[m].searchMode||(d=a[m].id,e=a[m].name,c=a[m].selectExpress,f=a[m].selectType,g=a[m].selectAttr,h=a[m].labelType,k=na(c),"2"==h?P(d,0,e,c,k,f,!0,g):P(d,Q,e,c,k,f,!1,g))}b&&b()}}
function Ia(b){jQuery("#ncx_toolview .ncx-export-window").each(function(){if(jQuery(this).is(":visible")){var a=jQuery(this).find(".title").text(),d="";if(jQuery(this).hasClass("ncx-export-window-wordpress")){var e=jQuery(this).find("input[name=__sign]").val(),c=jQuery(this).find("input[name=__url]").val();null!=c&&""!=c&&(c="http://"+c+"/?__ta=post");var f=jQuery(this).find("select[name=post_status]").val(),g=jQuery(this).find("input[name=access_password]").val(),h=jQuery(this).find("input[name=isUploadImage]").is(":checked"),
k="";h&&(k=jQuery(this).find("input[name=isUploadImage]").parent().find("input[name=param]").val(),h="Y");null!=e&&""!=e&&(d="__sign="+e);null!=f&&""!=f&&(""!=d&&(d+="&"),d+="postStatus="+f);null!=g&&""!=g&&(""!=d&&(d+="&"),d+="accessword="+g);jQuery(this).find(".fieldMap input[name=param]").each(function(){var a=this.value,b=jQuery(this).parent().parent().find("select.allFileds").val();null!=b&&""!=b&&(""!=d&&(d+="&"),d+=a+"="+b)});b.deployUrl=c;b.isUploadImage=h;b.imageLabels=k}else if(jQuery(this).hasClass("ncx-export-window-db")){var e=
jQuery(this).find("select[name=dbType]").val(),c=jQuery(this).find("input[name=dbHost]").val(),f=jQuery(this).find("input[name=dbPort]").val(),g=jQuery(this).find("input[name=dbName]").val(),h=jQuery(this).find("input[name=dbUser]").val(),k=jQuery(this).find("input[name=dbPassword]").val(),m=jQuery(this).find("select[name=dbCharset]").val();jQuery(this).find(".fieldMap > div:not(.temp)").find("input[name=param]").each(function(){var a=this.value,b=jQuery(this).parent().find("input[name=labelName]").val();
null!=b&&""!=b&&(""!=d&&(d+="&"),d+=a+"="+b)});b.dbType=e;b.dbHost=c;b.dbPort=f;b.dbName=g;b.dbUser=h;b.dbPassword=k;b.dbCharset=m}else if(jQuery(this).hasClass("ncx-export-window-rss")){var p={};jQuery(this).find(".fieldMap input[name=param]").each(function(){var a=this.value,b=jQuery(this).parent().parent().find("select.allFileds").val();if(void 0==b||null==b)b="";p[a]=b});e=$.toJSON(p);b.export2RSS=e}b.deployParams=d;b.deployName=a}});return b}
function Da(b){var a="",d;for(d in b)if(!isNaN(d)){var e=b[d].name,a=b[d].value,e=jQuery("#ncx_toolview .ncx-export-window-rss").find("input[name='param'][value='"+e+"']");jQuery(e).parent().parent().find("select.allFileds").val(a)}}
function Ea(b){var a=b.deployUrl,d=b.deployParams;"Y"==b.isUploadImage&&jQuery("#ncx_toolview .ncx-export-window-wordpress").find("input[name=isUploadImage]").attr("checked",!0);0==a.indexOf("http://")&&(a=a.substring(7));-1!=a.indexOf("/?__ta=post")&&(a=a.substring(0,a.indexOf("/?__ta=post")));jQuery("#ncx_toolview .ncx-export-window-wordpress").find("input[name=__url]").val(a);if(null!=d&&""!=d)for(b=d.split("&"),a=0,d=b.length;a<d;a++){var e=b[a].split("="),c=e[0],e=e[1];"__sign"==c?jQuery("#ncx_toolview .ncx-export-window-wordpress").find("input[name='__sign']").val(e):
"postStatus"==c?jQuery("#ncx_toolview .ncx-export-window-wordpress").find("select[name='post_status']").val(e):"accessword"==c?jQuery("#ncx_toolview .ncx-export-window-wordpress").find("input[name='access_password']").val(e):(c=jQuery("#ncx_toolview .ncx-export-window-wordpress").find("input[name='param'][value='"+c+"']"),jQuery(c).parent().parent().find("select.allFileds").val(e))}}
function Fa(b){var a=b.deployParams,d=b.dbHost,e=b.dbPort,c=b.dbName,f=b.dbUser,g=b.dbPassword,h=b.dbCharset;b=b.dbTable;jQuery("#ncx_toolview .ncx-export-window-db").find("input[name='dbHost']").val(d);jQuery("#ncx_toolview .ncx-export-window-db").find("input[name='dbPort']").val(e);jQuery("#ncx_toolview .ncx-export-window-db").find("input[name='dbName']").val(c);jQuery("#ncx_toolview .ncx-export-window-db").find("input[name='dbUser']").val(f);jQuery("#ncx_toolview .ncx-export-window-db").find("input[name='dbPassword']").val(g);
jQuery("#ncx_toolview .ncx-export-window-db").find("select[name='dbCharset']").val(h);jQuery("#ncx_toolview .ncx-export-window-db").find("input[name='dbTable']").val(b);if(null!=a&&""!=a)for(a=a.split("&"),d=0,e=a.length;d<e;d++)f=a[d].split("="),c=f[0],f=f[1],f=jQuery("#ncx_toolview .ncx-export-window-db").find("input[name='labelName'][value='"+f+"']"),jQuery(f).parent().find("input[name='param']").val(c)}
function ya(b){var a=newcrawler_server_url,d=[],e;for(e in D){var c=D[e].id,f=D[e].index,g=D[e].name,h=D[e].c,k=D[e].g,m=D[e].f;if(null!=g&&""!=g&&null!=h&&""!=h){var p="1";0==f&&(p="2");var t=f="",y=!1;"Headline"==g&&(f="true",t=[],t.push("enter"),t.push("space_trim"),t=JSON.stringify(t),y=!0);"Link"==g&&(f="true",y=!0);var H="";"Item"==g&&(H="true");d.push({id:c,name:g,selectExpress:h,selectAttr:m,selectType:k,labelType:p,isCantNull:f,isTemp:H,excludeHtmlTags:t,unique:y})}}jQuery("#ncx_toolbar .ncx-toolbar-section.msg").html("<div class='loading'></div>");
e="";null!=d&&0<d.length&&(e=JSON.stringify(d));d=jQuery("#ncx_toolbar #ncx-cron-id").val();c=jQuery("#ncx_toolbar #ncx-cron-date").val();g=jQuery("#ncx_toolbar #ncx-cron-time").val();h="";k=!1;jQuery("#ncx_toolbar .ncx-js input[type=checkbox][name='ncx-isJs']").is(":checked")&&(k=!0,h=jQuery("#ncx_toolbar .ncx-js #ncx-pluginId").val());m=jQuery("#ncx_toolbar #ncx-charset").val();p=jQuery("#ncx_toolbar #ncx-headers").val();urlString=a+"member/rules/save";a={webCrawlerId:R,siteId:S,rulesVerId:T,rulesJson:e,
url:jQuery("#ncx_toolbar #url").parent().attr("title"),cronId:d,cronDate:c,cronTime:g,isJs:k,pluginId:h,charset:m,headers:p};a=Ia(a);jQuery.ajax({type:"POST",data:a,url:urlString,async:!0,dataType:"json",error:function(a,b,c){console.log(c);jQuery("#ncx_toolbar .ncx-toolbar-section.msg").html("<div><span style='color:red;'>System errors.</span></div>");setTimeout(function(){jQuery("#ncx_toolbar .ncx-toolbar-section.msg").html("")},3E3)},success:function(a){var c=a.msg;if("1"==a.code){var d=a.cronId;
null!=d&&void 0!=d&&"undefined"!=d&&jQuery("#ncx_toolbar #ncx-cron-id").val(d);var d=a.isNew,e=a.pluginId;null!=e&&void 0!=e&&"undefined"!=e&&jQuery("#ncx_toolbar .ncx-js #ncx-pluginId").val(e);null!=a.siteId&&""!=a.siteId&&(S=a.siteId,"true"==d&&(V=V+"&siteId="+S));null!=a.rulesVerId&&""!=a.rulesVerId&&(T=a.rulesVerId,"true"==d&&(V=V+"&rulesVerId="+T));if(newcrawler_refresh&&null!=newcrawler_refresh&&void 0!=newcrawler_refresh&&"undefined"!=newcrawler_refresh)try{newcrawler_refresh()}catch(f){console.log(f.description||
f)}c="<span style='color:green;'>"+c+"</span>";b&&b();"true"==d&&(top.window.location.href=V)}else c="<span style='color:red;'>"+c+"</span>";jQuery("#ncx_toolbar .ncx-toolbar-section.msg").html("<div>"+c+"</div>");setTimeout(function(){jQuery("#ncx_toolbar .ncx-toolbar-section.msg").html("")},3E3)}})}
function za(b){jQuery("#ncx_tooltest > .ncx-content-top").find(".loading").show();jQuery("#ncx_tooltest > .ncx-content-top > .ncx-content-top-data table").empty();for(var a="",d=D.length,e=1;e<d;e++)var c=D[e].index,f=D[e].name,a=a+"<th>",a=a+f,a=a+"</th>";""!=a&&jQuery("<tr><th>index</th>"+a+"</tr>").appendTo(jQuery("#ncx_tooltest > .ncx-content-top > .ncx-content-top-data table"));Z.crawlRulesService.test(function(a,b){if(b){var e="System errors.";b.b&&(e=b.b);Y("fade",e,3E3,"red")}else if(e=eval("("+
a+")"),null==e||null==e.list||1>e.list.length){var f;jQuery("<tr><td  style='border: none;'>Not Found Data.</td>").appendTo(jQuery("#ncx_tooltest > .ncx-content-top > .ncx-content-top-data table"))}else{jQuery("#ncx_tooltest .ncx-details-content .spider").text(null==e.l?"":e.l);jQuery("#ncx_tooltest .ncx-details-content .cookie").text(null==e.h?"":e.h);f=null==e.j?"":e.j;jQuery("#ncx_tooltest .ncx-details-content .nextUrl").text(f);jQuery("#ncx_tooltest .ncx-details-content .nextUrl").attr("href",
f);jQuery("#ncx_tooltest .ncx-details-content .costTotal").text(e.u);jQuery("#ncx_tooltest .ncx-details-content .costFetch").text(e.s);jQuery("#ncx_tooltest .ncx-details-content .costParse").text(e.o);c=0;var e=e.list,p;for(p in e)if(!isNaN(p)){var t=e[p];c++;f="<tr><td>"+c+"</td>";for(var y=1;y<d;y++){var H=D[y].name,ha=!1,X;for(X in t)if(H==t[X].name){H=t[X].value;f+="<td>";f+=H;f+="</td>";ha=!0;break}ha||(f+="<td></td>")}f+="</tr>";f=jQuery(f);f.find("td").click(function(){jQuery(this).attr("title",
jQuery(this).text())});f.appendTo(jQuery("#ncx_tooltest > .ncx-content-top > .ncx-content-top-data table"))}jQuery("#ncx_tooltest .ncx-details-content .total").text(c)}},R,S,T,b,"")}
function Ca(){jQuery("#ncx_toolview > .ncx-content-top").find(".loading").show();jQuery("#ncx_toolview > .ncx-content-top > .ncx-content-top-data table").empty();for(var b="",a=D.length,d=1;d<a;d++)var e=D[d].name,b=b+"<th>",b=b+e,b=b+"</th>";""!=b&&jQuery("<tr><th>index</th>"+b+"<th>status</th><th>createDate</th></tr>").appendTo(jQuery("#ncx_toolview > .ncx-content-top > .ncx-content-top-data table"));U=0;Ja();var c=jQuery("#ncx_toolview > .ncx-content-top").find("#ncx-pagination-size").val();Z.crawlDataService.count(function(a){sa=
a;var b=nc.i18n("res.page.prev"),d=nc.i18n("res.page.next");jQuery("#ncx_toolview > .ncx-content-top").find("#ncx-pagination").pagination(a,{num_edge_entries:2,num_display_entries:5,current_page:0,callback:function(a){U=a;Ja()},items_per_page:c,prev_text:b,next_text:d})},R,S)}
function Ja(){var b=U,a=D.length,d=jQuery("#ncx_toolview > .ncx-content-top > .ncx-content-top-data table");Ka(d);for(var e=jQuery("#ncx_toolview > .ncx-content-top").find("#ncx-pagination-size").val(),d=b*e,e=e/20,c=0,f=0,g=0;g<e;g++){var h=d+20*g;if(h>sa)break;var k=1;c++;Z.crawlDataService.query(function(c){f++;c=eval(c);if(null!=c&&0<c.length){U=b;for(var d in c)if(!isNaN(d)){for(var e=eval(c[d].data),g="<tr><td>"+k+"</td>",h=c[d].createDate,m=1==c[d].status?'<span class="label-info bg-green">'+
nc.i18n("res.published")+"</span>":"",ca=1;ca<a;ca++){var da=D[ca].name,ta=!1,ea;for(ea in e)if(da==e[ea].name){da=e[ea].value;g+="<td>";g+=da;g+="</td>";ta=!0;break}ta||(g+="<td></td>")}g+="<td>"+m+"</td><td>"+h+"</td></tr>";e=jQuery(g);e.find("td").click(function(){jQuery(this).attr("title",jQuery(this).text())});e.appendTo(jQuery("#ncx_toolview > .ncx-content-top > .ncx-content-top-data table"));k++}}else{var g;jQuery("<tr><td  style='border: none;'>Not Found Data.</td>").appendTo(jQuery("#ncx_toolview > .ncx-content-top > .ncx-content-top-data table"))}},
R,{javaClass:"com.soso.web.jsonrpc.bo.CrawlDataBo",siteId:S,startIndex:h,size:20,searchStarttime:null,searchEndtime:null})}var m=setInterval(function(){c===f&&(jQuery("#ncx_toolview > .ncx-content-top").find(".loading").hide(),clearInterval(m))},3E3)}function Ka(b){b=b.get(0);for(var a=b.rows.length-1;0<a;a--)b.deleteRow(a)}
function La(){wa();ua();V=top.window.location.href;jQuery("iframe[name=newcrawler]").height(jQuery(window).height()-46);jQuery(window).resize(function(){jQuery("iframe[name=newcrawler]").height(jQuery(window).height()-46)});jQuery(window).css("overflow","hidden");try{xa();var b=document.getElementById("newcrawler").contentWindow.getNewCrawlerUserAgent(),a=document.getElementById("newcrawler").contentWindow.getNewCrawlerCharset();jQuery("#ncx_toolbar #ncx-headers").val(b);jQuery("#ncx_toolbar #ncx-charset-select").val(a);
jQuery("#ncx_toolbar #ncx-charset-select").change();Ha(function(){jQuery(document).on("mousemove",function(){});jQuery(".ncx_toolbar_cover").remove();Ma()})}catch(d){}}
function Ma(){jQuery("#ncx_toolview .ncx-export-content select.allFileds").each(function(){jQuery(this).find("option:gt(0)").remove()});jQuery("#ncx_toolview .ncx-export-window-db .ncx-export-content .fieldMap > div:not(.temp)").remove();for(var b in D)if(0!=D[b].index){var a=D[b].name,d=D[b].c;null!=a&&""!=a&&null!=d&&""!=d&&(jQuery("#ncx_toolview .ncx-export-window-wordpress .ncx-export-content select.allFileds").append("<option value='${"+a+"}'>"+a+"</option>"),jQuery("#ncx_toolview .ncx-export-window-rss .ncx-export-content select.allFileds").append("<option value='"+
a+"'>"+a+"</option>"),d=jQuery("#ncx_toolview .ncx-export-window-db .ncx-export-content .fieldMap .temp").clone(),d.removeClass("temp"),d.show(),d.find(".labelName").text(a),d.find("input[name=labelName]").val("${"+a+"}"),d.find("input[name=param]").val(a),jQuery("#ncx_toolview .ncx-export-window-db .ncx-export-content .fieldMap").append(d))}}
function Ga(b){jQuery("#ncx_toolview .ncx-export-window-wordpress .ncx-export-content select.allFileds").each(function(){var a=jQuery(this);a.find("option[value='${"+b+"}']").is(":checked")&&a.val("");a.find("option[value='${"+b+"}']").remove()});jQuery("#ncx_toolview .ncx-export-window-db .ncx-export-content .fieldMap input[name=param][value="+b+"]").parent().remove();jQuery("#ncx_toolview .ncx-export-window-rss .ncx-export-content select.allFileds").each(function(){var a=jQuery(this);a.find("option[value='"+
b+"']").is(":checked")&&a.val("");a.find("option[value='"+b+"']").remove()})}function Na(){Y("fade","Completed.",3E3,"green");La()}var Z,Aa,Ba;
jQuery(document).ready(function(){jQuery("#ncx_toolbar #ncx-cron-time").clockpicker({placement:"bottom",align:"top",autoclose:!0});jQuery("#ncx_toolbar #ncx-cron-date").datetimepicker({timepicker:!1,validateOnBlur:!1,closeOnDateSelect:!0,format:"Y-m-d"});JSONRpcClient.profile_async=!0;JSONRpcClient.max_req_active=2;JSONRpcClient.requestId=1;Z=jsonrpc=new JSONRpcClient("../JSON-RPC/MEMBER");Aa=logsViewConsole;logsViewConsole.fn.init();Ba=function(){jQuery(".logsViewConsole").click()};var b=getUrlParameter("webCrawlerId"),
a=getUrlParameter("siteId");W=new crawlDataLog({tableId:"ncx-crawlDataLog",listTableId:"ncx-crawlDataLogList",PER_PAGE_ITEMS:5,ITEMS_COUNT:0,cur_page:0,webCrawlerId:b,siteId:a});b=jQuery("#newcrawler")[0];b.attachEvent?b.attachEvent("onload",function(){Na()}):b.onload=function(){Na()};Y("show","Loading...");b.src=newcrawler_url});
(function(b){b.fn.i=function(){var a={handle:".ncx_et_bar"},a=b.extend({handle:"",cursor:"move"},a);(""===a.handle?this:this.find(a.handle)).css("cursor",a.cursor).on("mousedown",function(d){var e=""===a.handle?b(this).addClass("draggable"):b(this).addClass("active-handle").parent().addClass("draggable"),c=e.css("z-index"),f=e.outerHeight(),g=e.outerWidth(),h=e.offset().top+f-d.pageY,k=e.offset().left+g-d.pageX;e.css("z-index",2147483488).parents().on("mousemove",function(a){b(".draggable").offset({top:a.pageY+
h-f,left:a.pageX+k-g}).on("mouseup",function(){b(this).removeClass("draggable").css("z-index",c)})});d.preventDefault()}).on("mouseup",function(){""===a.handle?b(this).removeClass("draggable"):b(this).removeClass("active-handle").parent().removeClass("draggable")}).on("mouseout",function(){""===a.handle?b(this).removeClass("draggable"):b(this).removeClass("active-handle").parent().removeClass("draggable")})}})(jQuery);
